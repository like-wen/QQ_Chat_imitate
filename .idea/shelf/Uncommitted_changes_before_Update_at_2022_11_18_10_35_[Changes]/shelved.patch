Index: Client/pom.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\">\r\n    <modelVersion>4.0.0</modelVersion>\r\n    <parent>\r\n        <groupId>org.springframework.boot</groupId>\r\n        <artifactId>spring-boot-starter-parent</artifactId>\r\n        <version>2.7.4</version>\r\n        <relativePath/> <!-- lookup parent from repository -->\r\n    </parent>\r\n    <groupId>com.lkw</groupId>\r\n    <artifactId>Client</artifactId>\r\n    <version>0.0.1-SNAPSHOT</version>\r\n    <name>Client</name>\r\n    <description>Client</description>\r\n    <properties>\r\n        <java.version>1.8</java.version>\r\n    </properties>\r\n    <dependencies>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter</artifactId>\r\n        </dependency>\r\n\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-test</artifactId>\r\n            <scope>test</scope>\r\n        </dependency>\r\n\r\n        <dependency>\r\n            <groupId>com.alibaba.fastjson2</groupId>\r\n            <artifactId>fastjson2</artifactId>\r\n            <version>2.0.19</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.fasterxml.jackson.core</groupId>\r\n            <artifactId>jackson-databind</artifactId>\r\n            <version>2.13.3</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.projectlombok</groupId>\r\n            <artifactId>lombok</artifactId>\r\n            <version>1.18.24</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.slf4j</groupId>\r\n            <artifactId>slf4j-simple</artifactId>\r\n            <version>1.7.25</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.slf4j</groupId>\r\n            <artifactId>slf4j-api</artifactId>\r\n            <version>1.7.25</version>\r\n        </dependency>\r\n\r\n        <dependency>\r\n            <groupId>ch.qos.logback</groupId>\r\n            <artifactId>logback-core</artifactId>\r\n            <version>1.2.3</version>\r\n        </dependency>\r\n\r\n\r\n    </dependencies>\r\n\r\n    <build>\r\n        <plugins>\r\n            <plugin>\r\n                <groupId>org.springframework.boot</groupId>\r\n                <artifactId>spring-boot-maven-plugin</artifactId>\r\n            </plugin>\r\n        </plugins>\r\n    </build>\r\n\r\n</project>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/Client/pom.xml b/Client/pom.xml
--- a/Client/pom.xml	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ b/Client/pom.xml	(date 1668666942351)
@@ -29,38 +29,24 @@
         </dependency>
 
         <dependency>
-            <groupId>com.alibaba.fastjson2</groupId>
-            <artifactId>fastjson2</artifactId>
-            <version>2.0.19</version>
-        </dependency>
-        <dependency>
-            <groupId>com.fasterxml.jackson.core</groupId>
-            <artifactId>jackson-databind</artifactId>
-            <version>2.13.3</version>
-        </dependency>
-        <dependency>
-            <groupId>org.projectlombok</groupId>
-            <artifactId>lombok</artifactId>
-            <version>1.18.24</version>
-        </dependency>
-        <dependency>
-            <groupId>org.slf4j</groupId>
-            <artifactId>slf4j-simple</artifactId>
-            <version>1.7.25</version>
+            <groupId>org.springframework.boot</groupId>
+            <artifactId>spring-boot-starter</artifactId>
         </dependency>
+
         <dependency>
-            <groupId>org.slf4j</groupId>
-            <artifactId>slf4j-api</artifactId>
-            <version>1.7.25</version>
+        <groupId>de.roskenet</groupId>
+        <artifactId>springboot-javafx-support</artifactId>
+        <version>2.1.6</version>
         </dependency>
 
         <dependency>
-            <groupId>ch.qos.logback</groupId>
-            <artifactId>logback-core</artifactId>
-            <version>1.2.3</version>
+            <groupId>com.alibaba.fastjson2</groupId>
+            <artifactId>fastjson2</artifactId>
+            <version>2.0.19</version>
         </dependency>
 
 
+
     </dependencies>
 
     <build>
Index: Client/src/main/java/com/lkw/client/Thread/MyClientThread.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.lkw.client.Thread;\r\n\r\nimport com.lkw.client.Utils.Json2Object;\r\nimport com.lkw.client.Utils.Message;\r\nimport com.lkw.client.Utils.Object2Json;\r\nimport javafx.scene.control.Button;\r\nimport javafx.scene.control.TextArea;\r\nimport javafx.scene.text.Text;\r\n\r\nimport java.io.*;\r\nimport java.net.Socket;\r\nimport java.net.UnknownHostException;\r\n\r\nimport static com.lkw.client.Utils.FinalValue.MSG_GROUP;\r\nimport static com.lkw.client.Utils.FinalValue.MSG_PRIVATE;\r\n\r\n/**\r\n * 客户端\r\n * @author 花大侠\r\n *\r\n */\r\npublic class MyClientThread implements Runnable {\r\n\r\n\tprivate Socket socket;\r\n\r\n\tprivate Button sendBtn;\r\n\r\n\tprivate TextArea sendArea;\r\n\tprivate TextArea acceptArea;\r\n\r\n\tprivate Text toolTips;\r\n\r\n\tprivate String username;\r\n\r\n\r\n\tpublic MyClientThread(Button sendBtn, TextArea sendArea, TextArea acceptArea, Text toolTips, String username) {\r\n\t\tsuper();\r\n\t\tthis.sendBtn=sendBtn;\r\n\t\tthis.sendArea=sendArea;\r\n\t\tthis.acceptArea=acceptArea;\r\n\t\tthis.toolTips=toolTips;\r\n\t\tthis.username=username;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void run() {\r\n\t\ttry {\r\n\t\t\tsocket = new Socket(\"127.0.0.1\", 9999);\r\n\r\n\r\n\t\t\t//socket的输入输出\r\n\t\t\tBufferedReader bReader = new BufferedReader(new InputStreamReader(socket.getInputStream()));\r\n\t\t\tPrintWriter pWriter = new PrintWriter(socket.getOutputStream());\r\n\r\n\t\t\t//\"发送\"按钮的点击事件\r\n\t\t\tsendBtn.setOnAction(e->{\r\n\t\t\t\tString sendMsg=sendArea.getText();\r\n\t\t\t\tif(sendMsg.equals(\"\")){\r\n\t\t\t\t\ttoolTips.setText(\"没有内容\");\r\n\t\t\t\t}else {\r\n\r\n\t\t\t\t\t//形式\r\n\t\t\t\t\tString json = Object2Json.creat(username, \"text\").addObject(\"text\", sendMsg).buildJson();\r\n\t\t\t\t\t// Todo 判定群发以及私发\r\n\t\t\t\t\t//暂时为群发\r\n\t\t\t\t\tMessage message = new Message(1, sendMsg);\r\n\t\t\t\t\tpWriter.write( message + \"\\r\\n\");\r\n\t\t\t\t\tpWriter.flush();\r\n\t\t\t\t\tsendArea.setText(\"\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t//发消息\r\n\t\t\tString json;\r\n\r\n\t\t\t//收消息\r\n\t\t\twhile(true) {\r\n\t\t\t\t// json = bReader.readLine();\r\n\t\t\t\tString msg = bReader.readLine();\r\n\t\t\t\t//解析json\r\n\t\t\t\tJson2Object json2Object = new Json2Object(msg);\r\n\t\t\t\t//判断mode\r\n\t\t\t\tif(json2Object.getType()==MSG_GROUP||json2Object.getType()==MSG_PRIVATE){\r\n\t\t\t\t\tString message = json2Object.getMessage();\r\n\t\t\t\t\tacceptArea.appendText(message);\r\n\t\t\t\t\tSystem.out.println(\"收到\"+message);\r\n\t\t\t\t}else if(false){//其他情况\r\n\t\t\t\t\t//TODO 编写其他mode的\r\n\t\t\t\t}\r\n\t\t\t\t// if(json2Object.getMode().equals(\"text\")){\r\n\t\t\t\t// \tString message = json2Object.Json2Text();\r\n\t\t\t\t// \tacceptArea.appendText(message);\r\n\t\t\t\t// \tSystem.out.println(\"收到\"+message);\r\n\t\t\t\t// }else if(false){//其他情况\r\n\t\t\t\t// \t//TODO 编写其他mode的\r\n\t\t\t\t// }\r\n\t\t\t}\r\n\t\t} catch (UnknownHostException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t} catch (IOException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t}\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/Client/src/main/java/com/lkw/client/Thread/MyClientThread.java b/Client/src/main/java/com/lkw/client/Thread/MyClientThread.java
--- a/Client/src/main/java/com/lkw/client/Thread/MyClientThread.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ b/Client/src/main/java/com/lkw/client/Thread/MyClientThread.java	(date 1668738877687)
@@ -1,7 +1,6 @@
 package com.lkw.client.Thread;
 
 import com.lkw.client.Utils.Json2Object;
-import com.lkw.client.Utils.Message;
 import com.lkw.client.Utils.Object2Json;
 import javafx.scene.control.Button;
 import javafx.scene.control.TextArea;
@@ -10,9 +9,8 @@
 import java.io.*;
 import java.net.Socket;
 import java.net.UnknownHostException;
-
-import static com.lkw.client.Utils.FinalValue.MSG_GROUP;
-import static com.lkw.client.Utils.FinalValue.MSG_PRIVATE;
+import java.text.SimpleDateFormat;
+import java.util.Date;
 
 /**
  * 客户端
@@ -46,8 +44,6 @@
 	public void run() {
 		try {
 			socket = new Socket("127.0.0.1", 9999);
-
-
 			//socket的输入输出
 			BufferedReader bReader = new BufferedReader(new InputStreamReader(socket.getInputStream()));
 			PrintWriter pWriter = new PrintWriter(socket.getOutputStream());
@@ -58,42 +54,34 @@
 				if(sendMsg.equals("")){
 					toolTips.setText("没有内容");
 				}else {
-
 					//形式
-					String json = Object2Json.creat(username, "text").addObject("text", sendMsg).buildJson();
-					// Todo 判定群发以及私发
-					//暂时为群发
-					Message message = new Message(1, sendMsg);
-					pWriter.write( message + "\r\n");
+					String json1 = Object2Json.creat(username, "text").addObject("text", sendMsg).buildJson();
+					//传出的时候要加"\r\n"否则可能报错
+					pWriter.write( json1+ "\r\n");
 					pWriter.flush();
 					sendArea.setText("");
 				}
 			});
-
 			//发消息
 			String json;
-
 			//收消息
 			while(true) {
-				// json = bReader.readLine();
-				String msg = bReader.readLine();
+				json = bReader.readLine();
+
+				System.out.println(json);
 				//解析json
-				Json2Object json2Object = new Json2Object(msg);
+				Json2Object json2Object = new Json2Object(json);
 				//判断mode
-				if(json2Object.getType()==MSG_GROUP||json2Object.getType()==MSG_PRIVATE){
-					String message = json2Object.getMessage();
-					acceptArea.appendText(message);
+				if(json2Object.getMode().equals("text")){
+					String message = json2Object.Json2Text();
+					SimpleDateFormat sdf = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
+
+
+					acceptArea.appendText(json2Object.getUsername()+" "+sdf.format(new Date())+"\n"+message+"\n");
 					System.out.println("收到"+message);
 				}else if(false){//其他情况
 					//TODO 编写其他mode的
 				}
-				// if(json2Object.getMode().equals("text")){
-				// 	String message = json2Object.Json2Text();
-				// 	acceptArea.appendText(message);
-				// 	System.out.println("收到"+message);
-				// }else if(false){//其他情况
-				// 	//TODO 编写其他mode的
-				// }
 			}
 		} catch (UnknownHostException e) {
 			e.printStackTrace();
@@ -102,4 +90,4 @@
 		}
 	}
 
-}
+}
\ No newline at end of file
Index: Server/src/main/java/com/lkw/server/ServerUI.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.lkw.server;\r\n\r\nimport com.lkw.server.FileServer.MyFileServer;\r\nimport com.lkw.server.Server.MyServer;\r\nimport javafx.application.Application;\r\nimport javafx.collections.FXCollections;\r\nimport javafx.collections.ObservableList;\r\nimport javafx.event.EventHandler;\r\nimport javafx.geometry.Insets;\r\nimport javafx.scene.Scene;\r\nimport javafx.scene.control.*;\r\nimport javafx.scene.layout.GridPane;\r\nimport javafx.scene.layout.HBox;\r\nimport javafx.scene.layout.VBox;\r\nimport javafx.stage.Stage;\r\nimport javafx.stage.WindowEvent;\r\n\r\nimport java.io.PrintWriter;\r\nimport java.util.HashSet;\r\nimport java.util.Set;\r\n\r\npublic class ServerUI extends Application{\r\n\r\n\tTextArea receivedMsgArea = new TextArea();\r\n\tTextField ipText = new TextField();\r\n\tTextField portText = new TextField();\r\n\tTextArea sendMsgArea = new TextArea();\r\n\tTextField statusText = new TextField();\r\n\tButton sendButton = new Button(\" Send\");\r\n\tObservableList<String> clients = FXCollections.observableArrayList();\r\n\tListView<String> clientListView = new ListView<>(clients);\r\n\r\n\tpublic void start(Stage primaryStage) throws Exception {\r\n\r\n\t\t//右边 Received Message\r\n\t\tGridPane rightPane = new GridPane();\r\n\t\trightPane.setPadding(new Insets(11.5, 12.5, 13.5, 14.5));\r\n\t\trightPane.setHgap(5.5);\r\n\t\trightPane.setVgap(5.5);\r\n\t\trightPane.add(new Label(\"Received Message:\"), 0, 0);\r\n\t\treceivedMsgArea.setWrapText(true);\r\n\t\treceivedMsgArea.setEditable(false);\r\n\t\treceivedMsgArea.setMaxWidth(350);\r\n\t\treceivedMsgArea.setPrefHeight(410);\r\n\t\trightPane.add(receivedMsgArea, 0, 1);\r\n\r\n\t\t//左边 IPAdress+Port\r\n\t\tGridPane leftPane1 = new GridPane();\r\n\t\tleftPane1.setPadding(new Insets(11.5, 12.5, 13.5, 14.5));\r\n\t\tleftPane1.setHgap(5.5);\r\n\t\tleftPane1.setVgap(5.5);\r\n\t\tleftPane1.add(new Label(\"IPAdress:\"), 0, 0);\r\n\t\tipText.setEditable(false);\r\n\t\tleftPane1.add(ipText, 1, 0);\r\n\t\tleftPane1.add(new Label(\"Port:\"), 0, 1);\r\n\t\tportText.setEditable(false);\r\n\t\tleftPane1.add(portText, 1, 1);\r\n\r\n\t\t//左边 Choose Client\r\n\t\tGridPane leftPane2 = new GridPane();\r\n\t\tleftPane2.setPadding(new Insets(11.5, 12.5, 13.5, 14.5));\r\n\t\tleftPane2.setHgap(5.5);\r\n\t\tleftPane2.setVgap(5.5);\r\n\t\tleftPane2.add(new Label(\"Choose Client:\"), 0, 0);\r\n\t\tclientListView.getSelectionModel().setSelectionMode(SelectionMode.MULTIPLE);\r\n\t\tclientListView.setMaxHeight(80);\r\n\t\tclientListView.setMaxWidth(275);\r\n\t\tleftPane2.add(clientListView, 0, 1);\r\n\t\t//左边 Send Message\r\n\t\tleftPane2.add(new Label(\"Send Message:\"), 0, 2);\r\n\t\tsendMsgArea.setMaxHeight(150);\r\n\t\tsendMsgArea.setMaxWidth(275);\r\n\t\tsendMsgArea.setWrapText(true);\r\n\t\tleftPane2.add(sendMsgArea, 0, 3);\r\n\r\n\t\t//左边 Connect Status + button\r\n\t\tGridPane leftPane3 = new GridPane();\r\n\t\tleftPane3.setPadding(new Insets(11.5, 12.5, 13.5, 14.5));\r\n\t\tleftPane3.setHgap(5.5);\r\n\t\tleftPane3.setVgap(5.5);\r\n\t\tstatusText.setEditable(false);\r\n\t\tleftPane3.add(statusText, 0, 0);\r\n\t\tleftPane3.add(sendButton, 1, 0);\r\n\r\n\t\t//组合\r\n\t\tVBox vBox = new VBox();\r\n\t\tvBox.getChildren().addAll(leftPane1, leftPane2, leftPane3);\r\n\t\tHBox hBox = new HBox();\r\n\t\thBox.getChildren().addAll(vBox, rightPane);\r\n\r\n\t\tScene scene = new Scene(hBox);\r\n\t\tprimaryStage.setTitle(\"server\");\r\n\t\tprimaryStage.setScene(scene);\r\n\t\t//关闭UI线程时同时关闭各子线程\r\n\t\tprimaryStage.setOnCloseRequest(new EventHandler<WindowEvent>() {\r\n            @Override\r\n            public void handle(WindowEvent event) {\r\n                System.exit(0);\r\n            }\r\n        });\r\n\r\n\t\t//启动server线程\r\n\t\tnew Thread(new MyServer(ipText, portText, sendMsgArea, statusText, sendButton, receivedMsgArea, clients, clientListView)).start();\r\n\t\t//缝合进的文件server线程\r\n\t\t// new Thread(new MyFileServer()).start();\r\n\t\tprimaryStage.show();\r\n\t}\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/Server/src/main/java/com/lkw/server/ServerUI.java b/Server/src/main/java/com/lkw/server/ServerUI.java
--- a/Server/src/main/java/com/lkw/server/ServerUI.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ b/Server/src/main/java/com/lkw/server/ServerUI.java	(date 1668666871470)
@@ -15,23 +15,19 @@
 import javafx.stage.Stage;
 import javafx.stage.WindowEvent;
 
-import java.io.PrintWriter;
-import java.util.HashSet;
-import java.util.Set;
-
 public class ServerUI extends Application{
-
+	
 	TextArea receivedMsgArea = new TextArea();
 	TextField ipText = new TextField();
 	TextField portText = new TextField();
 	TextArea sendMsgArea = new TextArea();
 	TextField statusText = new TextField();
-	Button sendButton = new Button(" Send");
+	Button sendButton = new Button(" Send ");
 	ObservableList<String> clients = FXCollections.observableArrayList();
 	ListView<String> clientListView = new ListView<>(clients);
-
+	
 	public void start(Stage primaryStage) throws Exception {
-
+		
 		//右边 Received Message
 		GridPane rightPane = new GridPane();
 		rightPane.setPadding(new Insets(11.5, 12.5, 13.5, 14.5));
@@ -43,7 +39,7 @@
 		receivedMsgArea.setMaxWidth(350);
 		receivedMsgArea.setPrefHeight(410);
 		rightPane.add(receivedMsgArea, 0, 1);
-
+		
 		//左边 IPAdress+Port
 		GridPane leftPane1 = new GridPane();
 		leftPane1.setPadding(new Insets(11.5, 12.5, 13.5, 14.5));
@@ -55,7 +51,7 @@
 		leftPane1.add(new Label("Port:"), 0, 1);
 		portText.setEditable(false);
 		leftPane1.add(portText, 1, 1);
-
+		
 		//左边 Choose Client
 		GridPane leftPane2 = new GridPane();
 		leftPane2.setPadding(new Insets(11.5, 12.5, 13.5, 14.5));
@@ -72,7 +68,7 @@
 		sendMsgArea.setMaxWidth(275);
 		sendMsgArea.setWrapText(true);
 		leftPane2.add(sendMsgArea, 0, 3);
-
+		
 		//左边 Connect Status + button
 		GridPane leftPane3 = new GridPane();
 		leftPane3.setPadding(new Insets(11.5, 12.5, 13.5, 14.5));
@@ -81,13 +77,13 @@
 		statusText.setEditable(false);
 		leftPane3.add(statusText, 0, 0);
 		leftPane3.add(sendButton, 1, 0);
-
+		
 		//组合
 		VBox vBox = new VBox();
 		vBox.getChildren().addAll(leftPane1, leftPane2, leftPane3);
 		HBox hBox = new HBox();
 		hBox.getChildren().addAll(vBox, rightPane);
-
+		
 		Scene scene = new Scene(hBox);
 		primaryStage.setTitle("server");
 		primaryStage.setScene(scene);
@@ -102,7 +98,7 @@
 		//启动server线程
 		new Thread(new MyServer(ipText, portText, sendMsgArea, statusText, sendButton, receivedMsgArea, clients, clientListView)).start();
 		//缝合进的文件server线程
-		// new Thread(new MyFileServer()).start();
+		new Thread(new MyFileServer()).start();
 		primaryStage.show();
 	}
-}
+}
\ No newline at end of file
Index: Client/src/main/java/com/lkw/client/Controller/LoginController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.lkw.client.Controller;\r\n\r\nimport com.lkw.client.Main;\r\nimport com.lkw.client.Utils.Json2Object;\r\nimport com.lkw.client.Utils.Object2Json;\r\nimport javafx.fxml.FXML;\r\nimport javafx.fxml.Initializable;\r\nimport javafx.scene.control.*;\r\nimport javafx.scene.text.Text;\r\nimport javafx.stage.Stage;\r\n\r\nimport java.io.BufferedReader;\r\nimport java.io.IOException;\r\nimport java.io.InputStreamReader;\r\nimport java.io.PrintWriter;\r\nimport java.net.Socket;\r\nimport java.net.URL;\r\nimport java.net.UnknownHostException;\r\nimport java.util.ResourceBundle;\r\n\r\npublic class LoginController implements Initializable {\r\n\r\n    @FXML\r\n    private TextField username;\r\n\r\n    @FXML\r\n    private PasswordField password;\r\n\r\n    @FXML\r\n    private Text tips;\r\n\r\n   @FXML\r\n   private Button loginBtn;\r\n\r\n\r\n   @FXML\r\n   private  Button signUpBtn;\r\n\r\n   @FXML\r\n   private CheckBox selectBool;\r\n\r\n   private Socket socket;\r\n\r\n\r\n    @Override\r\n    public void initialize(URL location, ResourceBundle resources) {\r\n        new Thread(new MyLoginThread()).start();\r\n    }\r\n\r\n   public class MyLoginThread implements Runnable{\r\n\r\n       @Override\r\n       public void run() {\r\n           try {\r\n               socket = new Socket(\"127.0.0.1\", 9999);\r\n\r\n               //socket的输入输出\r\n               BufferedReader bReader = new BufferedReader(new InputStreamReader(socket.getInputStream()));\r\n               PrintWriter pWriter = new PrintWriter(socket.getOutputStream());\r\n\r\n               loginBtn.setOnAction(e->{\r\n                       String usernameText=username.getText();\r\n                   System.out.println(password);\r\n                       //形式\r\n                       //Todo 需要更改格式\r\n                       String json = Object2Json.creat(usernameText, \"login\")\r\n                               .addObject(\"password\", password.getText())\r\n                               .buildJson();\r\n                   System.out.println(json);\r\n                       pWriter.write( json+ \"\\r\\n\");\r\n                       pWriter.flush();\r\n               });\r\n\r\n               //发消息\r\n               String json;\r\n               //收消息\r\n               while(true) {\r\n                   System.out.println(\"循环\");\r\n                   json = bReader.readLine();\r\n                   //if(message.equals())\r\n                   System.out.println(json);\r\n                   Json2Object json2Object = new Json2Object(json);\r\n                   if(json2Object.getMode().equals(\"logged\")){\r\n                       boolean b = json2Object.Json2logged();\r\n                       if(b){\r\n                           new Main();\r\n                           //关闭窗口\r\n                           Stage stage = (Stage)signUpBtn.getScene().getWindow();\r\n                           stage.close();\r\n\r\n                       }\r\n\r\n\r\n                   }else if(false){\r\n                       //TODO\r\n\r\n                   }\r\n               }\r\n           } catch (UnknownHostException e) {\r\n               e.printStackTrace();\r\n           } catch (IOException e) {\r\n               e.printStackTrace();\r\n           }\r\n       }\r\n   }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/Client/src/main/java/com/lkw/client/Controller/LoginController.java b/Client/src/main/java/com/lkw/client/Controller/LoginController.java
--- a/Client/src/main/java/com/lkw/client/Controller/LoginController.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ b/Client/src/main/java/com/lkw/client/Controller/LoginController.java	(date 1668666942362)
@@ -3,6 +3,7 @@
 import com.lkw.client.Main;
 import com.lkw.client.Utils.Json2Object;
 import com.lkw.client.Utils.Object2Json;
+import javafx.application.Platform;
 import javafx.fxml.FXML;
 import javafx.fxml.Initializable;
 import javafx.scene.control.*;
@@ -44,6 +45,7 @@
 
     @Override
     public void initialize(URL location, ResourceBundle resources) {
+
         new Thread(new MyLoginThread()).start();
     }
 
@@ -53,54 +55,64 @@
        public void run() {
            try {
                socket = new Socket("127.0.0.1", 9999);
-
                //socket的输入输出
                BufferedReader bReader = new BufferedReader(new InputStreamReader(socket.getInputStream()));
                PrintWriter pWriter = new PrintWriter(socket.getOutputStream());
 
-               loginBtn.setOnAction(e->{
-                       String usernameText=username.getText();
+               loginBtn.setOnAction(e -> {
+                   String usernameText = username.getText();
                    System.out.println(password);
-                       //形式
-                       //Todo 需要更改格式
-                       String json = Object2Json.creat(usernameText, "login")
-                               .addObject("password", password.getText())
-                               .buildJson();
+                   //形式
+                   String json = Object2Json.creat(usernameText, "login")
+                           .addObject("password", password.getText())
+                           .buildJson();
                    System.out.println(json);
-                       pWriter.write( json+ "\r\n");
-                       pWriter.flush();
+                   //传出的时候要加"\r\n"否则可能报错
+                   pWriter.write(json + "\r\n");
+                   pWriter.flush();
                });
 
                //发消息
                String json;
                //收消息
-               while(true) {
+               while (true) {
                    System.out.println("循环");
                    json = bReader.readLine();
                    //if(message.equals())
                    System.out.println(json);
                    Json2Object json2Object = new Json2Object(json);
-                   if(json2Object.getMode().equals("logged")){
+                   if (json2Object.getMode().equals("logged")) {
                        boolean b = json2Object.Json2logged();
-                       if(b){
-                           new Main();
-                           //关闭窗口
-                           Stage stage = (Stage)signUpBtn.getScene().getWindow();
-                           stage.close();
+                       if (b) {
+                           Platform.runLater(() -> {
+                               try {
+                                   Stage stage = (Stage) signUpBtn.getScene().getWindow();
+                                   pWriter.close();
+                                   bReader.close();
+                                   socket.close();
+
+                                   Thread.interrupted();
+                                   new Main().start(stage);
+                                   return;
 
-                       }
+                               } catch (IOException e) {
+                                   throw new RuntimeException(e);
+                               }
 
 
-                   }else if(false){
+                           });
+                           return;
+                       }
+                   } else if (false) {
                        //TODO
-
                    }
+
                }
-           } catch (UnknownHostException e) {
-               e.printStackTrace();
-           } catch (IOException e) {
+           } catch (Exception e) {
                e.printStackTrace();
            }
        }
+
+
    }
 }
Index: Client/src/main/java/com/lkw/client/Main.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.lkw.client;\r\n\r\nimport javafx.application.Application;\r\nimport javafx.fxml.FXMLLoader;\r\nimport javafx.scene.Parent;\r\nimport javafx.scene.Scene;\r\nimport javafx.scene.image.Image;\r\nimport javafx.stage.Stage;\r\n\r\nimport java.io.IOException;\r\nimport java.util.Objects;\r\n\r\n\r\npublic class Main extends Application {\r\n    public static void main(String[] args) {\r\n        launch(args);\r\n    }\r\n\r\n    @Override\r\n    public void start(Stage primaryStage) {\r\n        Parent root = null;\r\n        try {\r\n            root = FXMLLoader.load(Objects.requireNonNull(getClass().getResource(\"/main.fxml\")));\r\n            primaryStage.setTitle(\"QQ\");\r\n            primaryStage.getIcons().add(new Image(\"/QQ.png\"));\r\n            primaryStage.setScene(new Scene(root));\r\n            primaryStage.show();\r\n        } catch (IOException e) {\r\n            e.printStackTrace();\r\n        }\r\n\r\n\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/Client/src/main/java/com/lkw/client/Main.java b/Client/src/main/java/com/lkw/client/Main.java
--- a/Client/src/main/java/com/lkw/client/Main.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ b/Client/src/main/java/com/lkw/client/Main.java	(date 1668666942375)
@@ -1,5 +1,6 @@
 package com.lkw.client;
 
+import com.lkw.client.Controller.JavafxController;
 import javafx.application.Application;
 import javafx.fxml.FXMLLoader;
 import javafx.scene.Parent;
@@ -20,11 +21,11 @@
     public void start(Stage primaryStage) {
         Parent root = null;
         try {
-            root = FXMLLoader.load(Objects.requireNonNull(getClass().getResource("/main.fxml")));
+            FXMLLoader loader = new FXMLLoader(getClass().getResource("/main.fxml"));
+            root = loader.load();
             primaryStage.setTitle("QQ");
             primaryStage.getIcons().add(new Image("/QQ.png"));
             primaryStage.setScene(new Scene(root));
-            primaryStage.show();
         } catch (IOException e) {
             e.printStackTrace();
         }
Index: Server/src/main/java/com/lkw/server/Server/MyServer.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.lkw.server.Server;\r\n\r\nimport com.lkw.server.Utils.Json2Object;\r\nimport com.lkw.server.Utils.Message;\r\nimport com.lkw.server.Utils.Utils;\r\nimport javafx.application.Platform;\r\nimport javafx.collections.ObservableList;\r\nimport javafx.scene.control.Button;\r\nimport javafx.scene.control.ListView;\r\nimport javafx.scene.control.TextArea;\r\nimport javafx.scene.control.TextField;\r\nimport lombok.extern.slf4j.Slf4j;\r\n\r\nimport java.io.*;\r\nimport java.net.InetSocketAddress;\r\nimport java.net.ServerSocket;\r\nimport java.net.Socket;\r\nimport java.nio.ByteBuffer;\r\nimport java.nio.channels.SelectionKey;\r\nimport java.nio.channels.Selector;\r\nimport java.nio.channels.ServerSocketChannel;\r\nimport java.nio.channels.SocketChannel;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.*;\r\nimport java.util.concurrent.atomic.AtomicBoolean;\r\nimport java.util.stream.Collectors;\r\n\r\nimport static com.lkw.server.Utils.FinalValue.*;\r\n\r\n\r\n@Slf4j\r\npublic class MyServer implements Runnable {\r\n\r\n\tprivate Selector selector;\r\n\tprivate ServerSocketChannel ssc;\r\n\r\n\tprivate UIhandler ui;\r\n\r\n\t//Server端监听的端口号\r\n\tpublic static final int PORT = 9999;\r\n\t//映射表 存放每个socket地址(IP:Port)及其对应的PrintWriter\r\n\t//为群发消息做准备\r\n\r\n\t//存放已连接socket地址(IP:Port)，用于clientListView\r\n\tObservableList<String> clients;\r\n\r\n\tListView<String> clientListView;\r\n\r\n\tTextField ipText;\r\n\tTextField portText;\r\n\tTextArea sendMsgArea;\r\n\tTextField statusText;\r\n\tButton sendButton;\r\n\tTextArea receivedMsgArea;\r\n\r\n\tpublic void init(int port) throws IOException{\r\n\t\t//1.获取一个ServerSocket通道\r\n\t\tssc = ServerSocketChannel.open();\r\n\t\t// System.out.println(ssc.isBlocking());\r\n\t\tssc.configureBlocking(false);////设置为非阻塞\r\n\t\t// System.out.println(ssc.isBlocking());\r\n\t\t//2.绑定监听，配置TCP参数，例如backlog大小\r\n\t\tssc.socket().bind(new InetSocketAddress(port));\r\n\t\t//3.获取通道管理器\r\n\t\tselector= Selector.open();\r\n\t\t//将通道管理器与通道绑定，并为该通道注册SelectionKey.OP_ACCEPT事件，\r\n\t\t//只有当该事件到达时，Selector.select()会返回，否则一直阻塞。\r\n\t\tssc.register(selector, SelectionKey.OP_ACCEPT);//注册channel到selector,监测接受此通道套接字的连接\r\n\t}\r\n\r\n\tpublic MyServer() {\r\n\t\ttry {\r\n\t\t\tinit(8888);\r\n\t\t} catch (IOException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic MyServer(TextField ipText, TextField portText, TextArea sendMsgArea, TextField statusText,\r\n\t\t\tButton sendButton, TextArea receivedMsgArea, ObservableList<String> clients, ListView<String> clientListView) {\r\n\t\tthis();\r\n\t\tthis.ui=new UIhandler(sendMsgArea,statusText,sendButton,receivedMsgArea,clients,clientListView);\r\n\t\tthis.ipText = ipText;\r\n\t\tthis.portText = portText;\r\n\t\tthis.sendMsgArea = sendMsgArea;\r\n\t\tthis.statusText = statusText;\r\n\t\tthis.sendButton = sendButton;\r\n\t\tthis.sendButton.setOnAction(event -> ToSelected());\r\n\t\tthis.receivedMsgArea = receivedMsgArea;\r\n\t\tthis.clients = clients;\r\n\t\tthis.clientListView = clientListView;\r\n\t}\r\n\r\n\t/**\r\n\t * 更新UI界面的IP和Port\r\n\t */\r\n\tpublic void updateIpAndPort() {\r\n\t\t//用于在非UI线程更新UI界面\r\n\t\tPlatform.runLater(()->{\r\n\t\t\tipText.setText(\"127.0.0.1\");\r\n\t\t\tportText.setText(String.valueOf(PORT));\r\n\t\t});\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void run() {\r\n\t\t// updateIpAndPort();\r\n\t\t// ServerSocket server;\r\n\t\t// Socket socket;\r\n\t\t// try {\r\n\t\t// \tserver = new ServerSocket(PORT);\r\n\t\t// \twhile(true) {\r\n\t\t// \t\tsocket = server.accept();\r\n\t\t// \t\t//一个客户端接入就启动一个handler线程去处理\r\n\t\t// \t\tnew Thread(new UIhandler(map, socket, sendMsgArea, statusText, sendButton, receivedMsgArea, clients, clientListView)).start();\r\n\t\t// \t}\r\n\t\t// } catch (IOException e) {\r\n\t\t// \t// TODO 自动生成的 catch 块\r\n\t\t// \te.printStackTrace();\r\n\t\t// }\r\n\r\n\t\ttry {\r\n\t\t\tlisten();\r\n\t\t} catch (Exception e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\tprivate void listen() throws Exception {\r\n\t\twhile (true) {\r\n\t\t\t// select 方法, 没有事件发生，线程阻塞，有事件，线程才会恢复运行, 通过Selector的select（）方法可以选择已经准备就绪的通道 （这些通道包含你感兴趣的的事件）\r\n\t\t\t//通过Selector的select（）方法可以选择已经准备就绪的通道 （这些通道包含你感兴趣的的事件）\r\n\t\t\t// select 在事件未处理时，它不会阻塞, 事件发生后要么处理，要么取消，不能置之不理\r\n\t\t\tselector.select();\r\n\t\t\t// 处理事件, selectedKeys 内部包含了所有发生的事件\r\n\t\t\tIterator<SelectionKey> iterator = selector.selectedKeys().iterator();\r\n\t\t\twhile (iterator.hasNext()) {\r\n\t\t\t\tSelectionKey key = iterator.next();\r\n\t\t\t\t// 处理key 时，要从 selectedKeys 集合中删除，否则下次处理就会有问题\r\n\t\t\t\titerator.remove();\r\n\r\n\t\t\t\t// 区分事件类型\r\n\t\t\t\tif (key.isAcceptable()) {\r\n\t\t\t\t\tServerSocketChannel channel = (ServerSocketChannel) key.channel();\r\n\r\n\t\t\t\t\tSocketChannel sc = channel.accept();\r\n\r\n\t\t\t\t\tsc.configureBlocking(false);\r\n\r\n\t\t\t\t\tsc.register(selector, SelectionKey.OP_READ);\r\n\r\n\t\t\t\t} else if (key.isReadable()) {\r\n\t\t\t\t\t//客户端是否发送信息\r\n\t\t\t\t\tdealReadEvent(key);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate void dealReadEvent(SelectionKey key) throws IOException {\r\n\t\tSocketChannel channel = null;\r\n\t\ttry {\r\n\t\t\tchannel = (SocketChannel) key.channel();\r\n\t\t\tByteBuffer buffer = ByteBuffer.allocate(1024);\r\n\t\t\tint read = channel.read(buffer);\r\n\t\t\t// 如果是正常断开，read 的方法的返回值是 -1\r\n\t\t\tif (read == -1) {\r\n\t\t\t\t//cancel 会取消注册在 selector 上的 channel，并从 keys 集合中删除 key 后续不会再监听事件\r\n\t\t\t\tkey.cancel();\r\n\t\t\t} else {\r\n\t\t\t\tbuffer.flip();\r\n\t\t\t\tMessage msg =  Utils.decode(buffer.array());\r\n\t\t\t\tlog.debug(msg.toString());\r\n\t\t\t\tSystem.out.println(\"SSS\");\r\n\t\t\t\tdealMessage(msg, key, channel);\r\n\t\t\t}\r\n\t\t} catch (IOException | ClassNotFoundException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t\tSystem.out.println((key.attachment() == null ? \"匿名用户\" : key.attachment()) + \" 离线了..\");\r\n\t\t\tdealMessage(new Message(MSG_SYSTEM, key.attachment() + \" 离线了..\"), key, channel);\r\n\t\t\tui.updateForDisConnect((String) key.attachment());\r\n\t\t\t//取消注册\r\n\t\t\tkey.cancel();\r\n\r\n\t\t\t//关闭通道\r\n\t\t\ttry {\r\n\t\t\t\tchannel.close();\r\n\t\t\t} catch (IOException ioException) {\r\n\t\t\t\tioException.printStackTrace();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected void dealMessage(Message msg, SelectionKey key, SocketChannel channel) {\r\n\t\tswitch (msg.type) {\r\n\t\t\tcase MSG_NAME:\r\n\t\t\t\tkey.attach(msg.message);\r\n\t\t\t\tlog.debug(\"用户{}已上线\", msg.message);\r\n\t\t\t\tui.updateForConnect(msg.message);\r\n\r\n\t\t\t\t// ui.addClients(msg.message);\r\n\t\t\t\tgetConnectedChannel(channel).forEach(\r\n\t\t\t\t\t\tselectionKey -> {\r\n\t\t\t\t\tSocketChannel sc = (SocketChannel) selectionKey.channel();\r\n\t\t\t\t\tsendMsgToClient(new Message(\"收到一条系统消息: \" + msg.message + \"已上线\"), sc);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase MSG_GROUP:\r\n\t\t\t\tgetConnectedChannel(channel).forEach(\r\n\t\t\t\t\t\tselectionKey ->\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\tSocketChannel sc = (SocketChannel) selectionKey.channel();\r\n\t\t\t\t\t\t\tMessage message = new Message(MSG_GROUP,key.attachment() + \"给大家发送了一条消息: \" + msg.message);\r\n\t\t\t\t\t\t\tsendMsgToClient(message, sc);\r\n\t\t\t\t\t\t\tSystem.out.println(message);\r\n\t\t\t\t\t\t});\r\n\t\t\t\treceivedMsgArea.appendText( key.attachment()+\" : \"+msg.message + \"\\n\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase MSG_PRIVATE:\r\n\t\t\t\tString[] s = msg.message.split(\"_\");\r\n\t\t\t\tAtomicBoolean flag = new AtomicBoolean(false);\r\n\t\t\t\tgetConnectedChannel(channel).stream()\r\n\t\t\t\t\t\t.filter(sk -> s[0].equals(sk.attachment()))\r\n\t\t\t\t\t\t.forEach(selectionKey ->\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\tSocketChannel sc = (SocketChannel) selectionKey.channel();\r\n\t\t\t\t\tsendMsgToClient(new Message(MSG_PRIVATE,key.attachment() + \"给你发送了一条消息: \" + s[1]), sc);\r\n\t\t\t\t\tflag.set(true);\r\n\t\t\t\t});\r\n\t\t\t\tif (!flag.get()){\r\n\t\t\t\t\tsendMsgToClient(new Message(s[1]+\"用户不存在,请重新输入！！！\"), channel);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase MSG_ONLINE:\r\n\t\t\t\tArrayList<String> onlineList = new ArrayList<>();\r\n\t\t\t\tonlineList.add((String) key.attachment());\r\n\t\t\t\tgetConnectedChannel(channel).forEach(\r\n\t\t\t\t\t\tselectionKey ->\r\n\t\t\t\t\t\t\t\tonlineList.add((String) selectionKey.attachment()));\r\n\t\t\t\tsendMsgToClient(new Message(onlineList.toString()), channel);\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tcase MSG_SYSTEM:\r\n\t\t\t\tgetConnectedChannel(channel).forEach(selectionKey -> {\r\n\t\t\t\t\tSocketChannel sc = (SocketChannel) selectionKey.channel();\r\n\t\t\t\t\tsendMsgToClient(new Message(\"收到一条系统消息: \" + msg.message), sc);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected void sendMsgToClient(Message msg, SocketChannel sc) {\r\n\t\ttry {\r\n\t\t\tbyte[] bytes =  Utils.encode(msg);\r\n\t\t\tsc.write(ByteBuffer.wrap(bytes));\r\n\t\t} catch (IOException e) {\r\n\t\t\tlog.debug(\"sendMsgToClient出现了一些问题\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate Set<SelectionKey> getConnectedChannel(SocketChannel channel) {\r\n\t\treturn selector.keys().stream()//流\r\n\t\t\t\t.filter(item -> item.channel() instanceof SocketChannel && item.channel().isOpen() && item.channel() != channel)\r\n\t\t\t\t//留下 除 调用者外的 打开的 socketchannel\r\n\t\t.collect(Collectors.toSet());//汇集\r\n\t}\r\n\tprivate void ToSelected(){\r\n\t\tif(ui.getSelected().size()<=0)\r\n\t\t\treturn;\r\n\t\tselector.keys().stream()\r\n\t\t\t\t.filter(i -> ui.getSelected().contains((String) i.attachment()))\r\n\t\t\t\t.forEach(sk ->\r\n\t\t\t\t{\r\n\t\t\t\t\tSocketChannel sc = (SocketChannel) sk.channel();\r\n\t\t\t\t\tsendMsgToClient(new Message(\"收到一条系统消息: \" + sendMsgArea.getText()), sc);\r\n\t\t\t\t});\r\n\r\n\r\n\t}\r\n\r\n\tclass UIhandler  {\r\n\t\tpublic void addClients(String name) {\r\n\t\t\tthis.clients.add(name);\r\n\t\t}\r\n\r\n\t\tpublic Set<String> getSelected() {\r\n\t\t\treturn selected;\r\n\t\t}\r\n\r\n\t\t// SocketChannel socket;\r\n\t\tTextArea sendMsgArea;\r\n\t\tTextField statusText;\r\n\t\tButton sendButton;\r\n\t\tTextArea receivedMsgArea;\r\n\t\tObservableList<String> clients;\r\n\t\tListView<String> clientListView;\r\n\r\n\t\tSet<String> selected = new HashSet<>();\r\n\r\n\t\tpublic UIhandler() {\r\n\r\n\r\n\r\n\t\t}\r\n\r\n\t\tpublic UIhandler (TextArea sendMsgArea, TextField statusText, Button sendButton,\r\n\t\t\t\t\t   TextArea receivedMsgArea, ObservableList<String> clients, ListView<String> clientListView) {\r\n\r\n\r\n\t\t\t//存取 socket, soncket的输出流\r\n\t\t\tthis.sendMsgArea = sendMsgArea;\r\n\t\t\tthis.statusText = statusText;\r\n\t\t\tthis.sendButton = sendButton;\r\n\t\t\tthis.receivedMsgArea = receivedMsgArea;\r\n\t\t\tthis.clients = clients;\r\n\t\t\tthis.clientListView = clientListView;\r\n\t\t\tclientListView.getSelectionModel().\r\n\t\t\t\t\tselectedItemProperty().\r\n\t\t\t\t\taddListener(ov->\r\n\t\t\t\t\t{ \tselected.clear();\r\n\t\t\t\t\t\tfor(String key: clientListView.getSelectionModel().getSelectedItems()) {\r\n\t\t\t\t\t\t\tselected.add(key);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t}\r\n\r\n\t\t// @Override\r\n\t\t// public void run() {\r\n\t\t// \tString remoteSocketAddress = null;\r\n\t\t// \ttry {\r\n\t\t// \t\tremoteSocketAddress = socket.getRemoteAddress().toString().substring(1);\r\n\t\t// \t} catch (IOException e) {\r\n\t\t// \t\te.printStackTrace();\r\n\t\t// \t}\r\n\t\t// \tupdateForConnect(remoteSocketAddress);\r\n\t\t// \ttry {\r\n\t\t//\r\n\t\t//\r\n\t\t// \t\tInputStream in = socket.getInputStream();\r\n\t\t// \t\tBufferedReader bReader = new BufferedReader(new InputStreamReader(in));\r\n\t\t// \t\tOutputStream out = socket.getOutputStream();\r\n\t\t// \t\tPrintWriter pWriter = new PrintWriter(out);\r\n\t\t// \t\tmap.put(remoteSocketAddress, pWriter);\r\n\t\t// \t\t//发消息\r\n\t\t// \t\tsendMessage();\r\n\t\t// \t\t//收消息\r\n\t\t// \t\tString json;\r\n\t\t// \t\twhile(true) {\r\n\t\t// \t\t\tjson = bReader.readLine();\r\n\t\t// \t\t\t//个人响应\r\n\t\t// \t\t\tSystem.out.println(\"收到\"+json);\r\n\t\t//\r\n\t\t// \t\t\t//解析json\r\n\t\t// \t\t\tJson2Object json2Object = new Json2Object(json);\r\n\t\t// \t\t\t//判断mode\r\n\t\t// \t\t\tif(json2Object.getMode().equals(\"login\")){\r\n\t\t// \t\t\t\tString returnJson = json2Object.Json2PasswordCheck();\r\n\t\t// \t\t\t\tSystem.out.println(\"发送\"+returnJson);\r\n\t\t// \t\t\t\tpWriter.write(returnJson);\r\n\t\t// \t\t\t\tpWriter.flush();\r\n\t\t// \t\t\t}else if(false){//其他情况\r\n\t\t// \t\t\t\t//TODO 编写其他mode的\r\n\t\t// \t\t\t}\r\n\t\t//\r\n\t\t//\r\n\t\t// \t\t\t//群转发\r\n\t\t// \t\t\t//][]\\]==\r\n\t\t// \t\t\t// sendMessage2All(json,pWriter);\r\n\t\t//\r\n\t\t//\r\n\t\t// \t\t\treceivedMsgArea.appendText(json + \"\\n\");\r\n\t\t// \t\t}\r\n\t\t// \t} catch (IOException e) {\r\n\t\t// \t\tupdateForDisConnect(remoteSocketAddress);\r\n\t\t// \t}\r\n\t\t// }\r\n\r\n\t\t/**\r\n\t\t * 接入客户端后，更新UI界面\r\n\t\t * 1.添加新接入客户端的地址信息\r\n\t\t * 2.receivedMsgarea打印成功连接信息\r\n\t\t * 3.statusText更新成功连接个数\r\n\t\t */\r\n\t\tpublic void updateForConnect(String remoteSocketAddress) {\r\n\t\t\tPlatform.runLater(()->{\r\n\t\t\t\tclients.add(remoteSocketAddress);\r\n\t\t\t\tSimpleDateFormat sdf = new SimpleDateFormat(\"HH:mm\");\r\n\t\t\t\treceivedMsgArea.appendText(String.valueOf(remoteSocketAddress + \" Connected \" + \" \" + sdf.format(new Date()) + \"\\n\"));\r\n\t\t\t\tstatusText.setText(String.valueOf(clients.size()) + \" Connect success.\");\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * 断开客户端后，更新UI界面\r\n\t\t * 1.移除断开客户端的地址信息\r\n\t\t * 2.receivedMsgarea打印断开连接信息\r\n\t\t * 3.statusText更新成功连接个数\r\n\t\t * 4.移除map中对应的remoteSocketAddress\r\n\t\t */\r\n\t\tpublic void updateForDisConnect(String remoteSocketAddress) {\r\n\t\t\tPlatform.runLater(()->{\r\n\t\t\t\tclients.remove(remoteSocketAddress);\r\n\t\t\t\tstatusText.setText(String.valueOf(clients.size()) + \" Connect success.\");\r\n\t\t\t\treceivedMsgArea.appendText(remoteSocketAddress + \" out of connected..\" + \"\\n\");\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * 给服务器选择的客户端进行发送\r\n\t\t * 1.为clientListView设置监听器\r\n\t\t *   1.1获取已选择的项(IP:Port)\r\n\t\t *   1.2从映射表中取出对应printWriter放入printWriters集合\r\n\t\t * 2.为sendButton设置鼠标点击事件\r\n\t\t *   2.1遍历printWriters集合\r\n\t\t *   2.2写入待发送的消息\r\n\t\t */\r\n\r\n\t\tpublic void sendMessage() {\r\n\t\t\tSet<PrintWriter> printWriters = new HashSet<>();\r\n\r\n\t\t\tclientListView.getSelectionModel().\r\n\t\t\t\t\tselectedItemProperty().\r\n\t\t\t\t\taddListener(ov->\r\n\t\t\t\t\t{ \tprintWriters.clear();\r\n\t\t\t\t\t\tfor(String key: clientListView.getSelectionModel().getSelectedItems()) {\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsendButton.setOnAction(e->{\r\n\t\t\t\tfor (PrintWriter printWriter : printWriters) {\r\n\t\t\t\t\tprintWriter.write(sendMsgArea.getText() + \"\\r\\n\");\r\n\t\t\t\t\tprintWriter.flush();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\r\n\t\t// /**\r\n\t\t//  * 单独发送以及群发\r\n\t\t//  * @param message\r\n\t\t//  * @param pWriter\r\n\t\t//  */\r\n\t\t// public void sendMessage2All(String message, PrintWriter pWriter){\r\n\t\t// \tfor (PrintWriter printWriter:map.values()){\r\n\t\t// \t\tif(!pWriter.equals(printWriter)) {\r\n\t\t// \t\t\tprintWriter.write(message);\r\n\t\t// \t\t\tprintWriter.flush();\r\n\t\t// \t\t}\r\n\t\t// \t}\r\n\t\t//\r\n\t\t// }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t}\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/Server/src/main/java/com/lkw/server/Server/MyServer.java b/Server/src/main/java/com/lkw/server/Server/MyServer.java
--- a/Server/src/main/java/com/lkw/server/Server/MyServer.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ b/Server/src/main/java/com/lkw/server/Server/MyServer.java	(date 1668666871523)
@@ -1,96 +1,54 @@
 package com.lkw.server.Server;
 
-import com.lkw.server.Utils.Json2Object;
-import com.lkw.server.Utils.Message;
-import com.lkw.server.Utils.Utils;
 import javafx.application.Platform;
 import javafx.collections.ObservableList;
 import javafx.scene.control.Button;
 import javafx.scene.control.ListView;
 import javafx.scene.control.TextArea;
 import javafx.scene.control.TextField;
-import lombok.extern.slf4j.Slf4j;
 
-import java.io.*;
-import java.net.InetSocketAddress;
+import java.io.IOException;
+import java.io.PrintWriter;
 import java.net.ServerSocket;
 import java.net.Socket;
-import java.nio.ByteBuffer;
-import java.nio.channels.SelectionKey;
-import java.nio.channels.Selector;
-import java.nio.channels.ServerSocketChannel;
-import java.nio.channels.SocketChannel;
-import java.text.SimpleDateFormat;
-import java.util.*;
-import java.util.concurrent.atomic.AtomicBoolean;
-import java.util.stream.Collectors;
-
-import static com.lkw.server.Utils.FinalValue.*;
+import java.util.HashMap;
+import java.util.Map;
 
-
-@Slf4j
 public class MyServer implements Runnable {
-
-	private Selector selector;
-	private ServerSocketChannel ssc;
-
-	private UIhandler ui;
-
+	
 	//Server端监听的端口号
 	public static final int PORT = 9999;
 	//映射表 存放每个socket地址(IP:Port)及其对应的PrintWriter
 	//为群发消息做准备
-
+	Map<String, PrintWriter> map = new HashMap<>();
 	//存放已连接socket地址(IP:Port)，用于clientListView
 	ObservableList<String> clients;
-
 	ListView<String> clientListView;
-
+	
 	TextField ipText;
 	TextField portText;
 	TextArea sendMsgArea;
 	TextField statusText;
 	Button sendButton;
 	TextArea receivedMsgArea;
-
-	public void init(int port) throws IOException{
-		//1.获取一个ServerSocket通道
-		ssc = ServerSocketChannel.open();
-		// System.out.println(ssc.isBlocking());
-		ssc.configureBlocking(false);////设置为非阻塞
-		// System.out.println(ssc.isBlocking());
-		//2.绑定监听，配置TCP参数，例如backlog大小
-		ssc.socket().bind(new InetSocketAddress(port));
-		//3.获取通道管理器
-		selector= Selector.open();
-		//将通道管理器与通道绑定，并为该通道注册SelectionKey.OP_ACCEPT事件，
-		//只有当该事件到达时，Selector.select()会返回，否则一直阻塞。
-		ssc.register(selector, SelectionKey.OP_ACCEPT);//注册channel到selector,监测接受此通道套接字的连接
-	}
-
+ 
 	public MyServer() {
-		try {
-			init(8888);
-		} catch (IOException e) {
-			e.printStackTrace();
-		}
+		
 	}
-
-	public MyServer(TextField ipText, TextField portText, TextArea sendMsgArea, TextField statusText,
+	
+	public MyServer(TextField ipText, TextField portText, TextArea sendMsgArea, TextField statusText, 
 			Button sendButton, TextArea receivedMsgArea, ObservableList<String> clients, ListView<String> clientListView) {
-		this();
-		this.ui=new UIhandler(sendMsgArea,statusText,sendButton,receivedMsgArea,clients,clientListView);
+		super();
 		this.ipText = ipText;
 		this.portText = portText;
 		this.sendMsgArea = sendMsgArea;
 		this.statusText = statusText;
 		this.sendButton = sendButton;
-		this.sendButton.setOnAction(event -> ToSelected());
 		this.receivedMsgArea = receivedMsgArea;
 		this.clients = clients;
 		this.clientListView = clientListView;
 	}
-
+	
 	/**
 	 * 更新UI界面的IP和Port
 	 */
@@ -101,364 +59,23 @@
 			portText.setText(String.valueOf(PORT));
 		});
 	}
-
+	
 	@Override
 	public void run() {
-		// updateIpAndPort();
-		// ServerSocket server;
-		// Socket socket;
-		// try {
-		// 	server = new ServerSocket(PORT);
-		// 	while(true) {
-		// 		socket = server.accept();
-		// 		//一个客户端接入就启动一个handler线程去处理
-		// 		new Thread(new UIhandler(map, socket, sendMsgArea, statusText, sendButton, receivedMsgArea, clients, clientListView)).start();
-		// 	}
-		// } catch (IOException e) {
-		// 	// TODO 自动生成的 catch 块
-		// 	e.printStackTrace();
-		// }
-
+		updateIpAndPort();
+		ServerSocket server;
+		Socket socket;
 		try {
-			listen();
-		} catch (Exception e) {
-			e.printStackTrace();
-		}
-
-
-	}
-
-	private void listen() throws Exception {
-		while (true) {
-			// select 方法, 没有事件发生，线程阻塞，有事件，线程才会恢复运行, 通过Selector的select（）方法可以选择已经准备就绪的通道 （这些通道包含你感兴趣的的事件）
-			//通过Selector的select（）方法可以选择已经准备就绪的通道 （这些通道包含你感兴趣的的事件）
-			// select 在事件未处理时，它不会阻塞, 事件发生后要么处理，要么取消，不能置之不理
-			selector.select();
-			// 处理事件, selectedKeys 内部包含了所有发生的事件
-			Iterator<SelectionKey> iterator = selector.selectedKeys().iterator();
-			while (iterator.hasNext()) {
-				SelectionKey key = iterator.next();
-				// 处理key 时，要从 selectedKeys 集合中删除，否则下次处理就会有问题
-				iterator.remove();
-
-				// 区分事件类型
-				if (key.isAcceptable()) {
-					ServerSocketChannel channel = (ServerSocketChannel) key.channel();
-
-					SocketChannel sc = channel.accept();
-
-					sc.configureBlocking(false);
-
-					sc.register(selector, SelectionKey.OP_READ);
-
-				} else if (key.isReadable()) {
-					//客户端是否发送信息
-					dealReadEvent(key);
-				}
-			}
-		}
-	}
-
-	private void dealReadEvent(SelectionKey key) throws IOException {
-		SocketChannel channel = null;
-		try {
-			channel = (SocketChannel) key.channel();
-			ByteBuffer buffer = ByteBuffer.allocate(1024);
-			int read = channel.read(buffer);
-			// 如果是正常断开，read 的方法的返回值是 -1
-			if (read == -1) {
-				//cancel 会取消注册在 selector 上的 channel，并从 keys 集合中删除 key 后续不会再监听事件
-				key.cancel();
-			} else {
-				buffer.flip();
-				Message msg =  Utils.decode(buffer.array());
-				log.debug(msg.toString());
-				System.out.println("SSS");
-				dealMessage(msg, key, channel);
-			}
-		} catch (IOException | ClassNotFoundException e) {
-			e.printStackTrace();
-			System.out.println((key.attachment() == null ? "匿名用户" : key.attachment()) + " 离线了..");
-			dealMessage(new Message(MSG_SYSTEM, key.attachment() + " 离线了.."), key, channel);
-			ui.updateForDisConnect((String) key.attachment());
-			//取消注册
-			key.cancel();
-
-			//关闭通道
-			try {
-				channel.close();
-			} catch (IOException ioException) {
-				ioException.printStackTrace();
-			}
-		}
-	}
-
-	protected void dealMessage(Message msg, SelectionKey key, SocketChannel channel) {
-		switch (msg.type) {
-			case MSG_NAME:
-				key.attach(msg.message);
-				log.debug("用户{}已上线", msg.message);
-				ui.updateForConnect(msg.message);
-
-				// ui.addClients(msg.message);
-				getConnectedChannel(channel).forEach(
-						selectionKey -> {
-					SocketChannel sc = (SocketChannel) selectionKey.channel();
-					sendMsgToClient(new Message("收到一条系统消息: " + msg.message + "已上线"), sc);
-				});
-				break;
-			case MSG_GROUP:
-				getConnectedChannel(channel).forEach(
-						selectionKey ->
-						{
-					SocketChannel sc = (SocketChannel) selectionKey.channel();
-							Message message = new Message(MSG_GROUP,key.attachment() + "给大家发送了一条消息: " + msg.message);
-							sendMsgToClient(message, sc);
-							System.out.println(message);
-						});
-				receivedMsgArea.appendText( key.attachment()+" : "+msg.message + "\n");
-				break;
-			case MSG_PRIVATE:
-				String[] s = msg.message.split("_");
-				AtomicBoolean flag = new AtomicBoolean(false);
-				getConnectedChannel(channel).stream()
-						.filter(sk -> s[0].equals(sk.attachment()))
-						.forEach(selectionKey ->
-						{
-					SocketChannel sc = (SocketChannel) selectionKey.channel();
-					sendMsgToClient(new Message(MSG_PRIVATE,key.attachment() + "给你发送了一条消息: " + s[1]), sc);
-					flag.set(true);
-				});
-				if (!flag.get()){
-					sendMsgToClient(new Message(s[1]+"用户不存在,请重新输入！！！"), channel);
-				}
-				break;
-			case MSG_ONLINE:
-				ArrayList<String> onlineList = new ArrayList<>();
-				onlineList.add((String) key.attachment());
-				getConnectedChannel(channel).forEach(
-						selectionKey ->
-								onlineList.add((String) selectionKey.attachment()));
-				sendMsgToClient(new Message(onlineList.toString()), channel);
-
-				break;
-			case MSG_SYSTEM:
-				getConnectedChannel(channel).forEach(selectionKey -> {
-					SocketChannel sc = (SocketChannel) selectionKey.channel();
-					sendMsgToClient(new Message("收到一条系统消息: " + msg.message), sc);
-				});
-				break;
-			default:
-				break;
-		}
-	}
-
-	protected void sendMsgToClient(Message msg, SocketChannel sc) {
-		try {
-			byte[] bytes =  Utils.encode(msg);
-			sc.write(ByteBuffer.wrap(bytes));
+			server = new ServerSocket(PORT);
+			while(true) {
+				socket = server.accept();
+				//一个客户端接入就启动一个handler线程去处理
+				new Thread(new handler(map, socket, sendMsgArea, statusText, sendButton, receivedMsgArea, clients, clientListView)).start();
+			}
 		} catch (IOException e) {
-			log.debug("sendMsgToClient出现了一些问题");
-		}
-	}
-
-	private Set<SelectionKey> getConnectedChannel(SocketChannel channel) {
-		return selector.keys().stream()//流
-				.filter(item -> item.channel() instanceof SocketChannel && item.channel().isOpen() && item.channel() != channel)
-				//留下 除 调用者外的 打开的 socketchannel
-		.collect(Collectors.toSet());//汇集
-	}
-	private void ToSelected(){
-		if(ui.getSelected().size()<=0)
-			return;
-		selector.keys().stream()
-				.filter(i -> ui.getSelected().contains((String) i.attachment()))
-				.forEach(sk ->
-				{
-					SocketChannel sc = (SocketChannel) sk.channel();
-					sendMsgToClient(new Message("收到一条系统消息: " + sendMsgArea.getText()), sc);
-				});
-
-
-	}
-
-	class UIhandler  {
-		public void addClients(String name) {
-			this.clients.add(name);
-		}
-
-		public Set<String> getSelected() {
-			return selected;
-		}
-
-		// SocketChannel socket;
-		TextArea sendMsgArea;
-		TextField statusText;
-		Button sendButton;
-		TextArea receivedMsgArea;
-		ObservableList<String> clients;
-		ListView<String> clientListView;
-
-		Set<String> selected = new HashSet<>();
-
-		public UIhandler() {
-
-
-
+			// TODO 自动生成的 catch 块
+			e.printStackTrace();
 		}
-
-		public UIhandler (TextArea sendMsgArea, TextField statusText, Button sendButton,
-					   TextArea receivedMsgArea, ObservableList<String> clients, ListView<String> clientListView) {
-
-
-			//存取 socket, soncket的输出流
-			this.sendMsgArea = sendMsgArea;
-			this.statusText = statusText;
-			this.sendButton = sendButton;
-			this.receivedMsgArea = receivedMsgArea;
-			this.clients = clients;
-			this.clientListView = clientListView;
-			clientListView.getSelectionModel().
-					selectedItemProperty().
-					addListener(ov->
-					{ 	selected.clear();
-						for(String key: clientListView.getSelectionModel().getSelectedItems()) {
-							selected.add(key);
-						}
-					});
-		}
-
-		// @Override
-		// public void run() {
-		// 	String remoteSocketAddress = null;
-		// 	try {
-		// 		remoteSocketAddress = socket.getRemoteAddress().toString().substring(1);
-		// 	} catch (IOException e) {
-		// 		e.printStackTrace();
-		// 	}
-		// 	updateForConnect(remoteSocketAddress);
-		// 	try {
-		//
-		//
-		// 		InputStream in = socket.getInputStream();
-		// 		BufferedReader bReader = new BufferedReader(new InputStreamReader(in));
-		// 		OutputStream out = socket.getOutputStream();
-		// 		PrintWriter pWriter = new PrintWriter(out);
-		// 		map.put(remoteSocketAddress, pWriter);
-		// 		//发消息
-		// 		sendMessage();
-		// 		//收消息
-		// 		String json;
-		// 		while(true) {
-		// 			json = bReader.readLine();
-		// 			//个人响应
-		// 			System.out.println("收到"+json);
-		//
-		// 			//解析json
-		// 			Json2Object json2Object = new Json2Object(json);
-		// 			//判断mode
-		// 			if(json2Object.getMode().equals("login")){
-		// 				String returnJson = json2Object.Json2PasswordCheck();
-		// 				System.out.println("发送"+returnJson);
-		// 				pWriter.write(returnJson);
-		// 				pWriter.flush();
-		// 			}else if(false){//其他情况
-		// 				//TODO 编写其他mode的
-		// 			}
-		//
-		//
-		// 			//群转发
-		// 			//][]\]==
-		// 			// sendMessage2All(json,pWriter);
-		//
-		//
-		// 			receivedMsgArea.appendText(json + "\n");
-		// 		}
-		// 	} catch (IOException e) {
-		// 		updateForDisConnect(remoteSocketAddress);
-		// 	}
-		// }
-
-		/**
-		 * 接入客户端后，更新UI界面
-		 * 1.添加新接入客户端的地址信息
-		 * 2.receivedMsgarea打印成功连接信息
-		 * 3.statusText更新成功连接个数
-		 */
-		public void updateForConnect(String remoteSocketAddress) {
-			Platform.runLater(()->{
-				clients.add(remoteSocketAddress);
-				SimpleDateFormat sdf = new SimpleDateFormat("HH:mm");
-				receivedMsgArea.appendText(String.valueOf(remoteSocketAddress + " Connected " + " " + sdf.format(new Date()) + "\n"));
-				statusText.setText(String.valueOf(clients.size()) + " Connect success.");
-			});
-		}
-
-		/**
-		 * 断开客户端后，更新UI界面
-		 * 1.移除断开客户端的地址信息
-		 * 2.receivedMsgarea打印断开连接信息
-		 * 3.statusText更新成功连接个数
-		 * 4.移除map中对应的remoteSocketAddress
-		 */
-		public void updateForDisConnect(String remoteSocketAddress) {
-			Platform.runLater(()->{
-				clients.remove(remoteSocketAddress);
-				statusText.setText(String.valueOf(clients.size()) + " Connect success.");
-				receivedMsgArea.appendText(remoteSocketAddress + " out of connected.." + "\n");
-			});
-		}
-
-		/**
-		 * 给服务器选择的客户端进行发送
-		 * 1.为clientListView设置监听器
-		 *   1.1获取已选择的项(IP:Port)
-		 *   1.2从映射表中取出对应printWriter放入printWriters集合
-		 * 2.为sendButton设置鼠标点击事件
-		 *   2.1遍历printWriters集合
-		 *   2.2写入待发送的消息
-		 */
-
-		public void sendMessage() {
-			Set<PrintWriter> printWriters = new HashSet<>();
-
-			clientListView.getSelectionModel().
-					selectedItemProperty().
-					addListener(ov->
-					{ 	printWriters.clear();
-						for(String key: clientListView.getSelectionModel().getSelectedItems()) {
-
-				}
-			});
-
-			sendButton.setOnAction(e->{
-				for (PrintWriter printWriter : printWriters) {
-					printWriter.write(sendMsgArea.getText() + "\r\n");
-					printWriter.flush();
-				}
-			});
-		}
-
-
-		// /**
-		//  * 单独发送以及群发
-		//  * @param message
-		//  * @param pWriter
-		//  */
-		// public void sendMessage2All(String message, PrintWriter pWriter){
-		// 	for (PrintWriter printWriter:map.values()){
-		// 		if(!pWriter.equals(printWriter)) {
-		// 			printWriter.write(message);
-		// 			printWriter.flush();
-		// 		}
-		// 	}
-		//
-		// }
-
-
-
-
-
-
-	}
-}
+	}
+ 
+}
\ No newline at end of file
Index: Client/src/main/java/com/lkw/client/Utils/FinalValue.java
===================================================================
diff --git a/Client/src/main/java/com/lkw/client/Utils/FinalValue.java b/Client/src/main/java/com/lkw/client/Utils/FinalValue.java
deleted file mode 100644
--- a/Client/src/main/java/com/lkw/client/Utils/FinalValue.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ /dev/null	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
@@ -1,40 +0,0 @@
-package com.lkw.client.Utils;
-
-/**
- * @author mazouri
- * @create 2021-05-05 21:00
- */
-public final class FinalValue {
-	/**
-	 * 系统消息
-	 */
-	public static final int MSG_SYSTEM = 0;
-	/**
-	 * 群发消息
-	 */
-	public static final int MSG_GROUP = 1;
-	/**
-	 * 私发消息
-	 */
-	public static final int MSG_PRIVATE = 2;
-	/**
-	 * 客户端请求在线人员
-	 */
-	public static final int MSG_ONLINE = 3;
-	/**
-	 * 客户端将用户名称发送给服务端
-	 */
-	public static final int MSG_NAME = 4;
-	/**
-	 * 客户端请求发送文件
-	 */
-	public static final int MSG_SentFile = 5;
-	/**
-	 * 客户端请求读取文件
-	 */
-	public static final int MSG_GetFile = 6;
-	/**
-	 * 文件消息
-	 */
-	public static final int MSG_File = 7;
-}
Index: Server/src/main/java/com/lkw/server/Utils/Utils.java
===================================================================
diff --git a/Server/src/main/java/com/lkw/server/Utils/Utils.java b/Server/src/main/java/com/lkw/server/Utils/Utils.java
deleted file mode 100644
--- a/Server/src/main/java/com/lkw/server/Utils/Utils.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ /dev/null	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
@@ -1,41 +0,0 @@
-package com.lkw.server.Utils;
-
-import lombok.extern.slf4j.Slf4j;
-import com.lkw.server.Utils.Message;
-import java.io.*;
-
-/**
- * @author mazouri
- * @create 2021-05-09 22:26
- */
-@Slf4j
-public class Utils {
-	/**
-	 * 将二进制数据转为对象
-	 *
-	 * @param buf
-	 * @return
-	 * @throws IOException
-	 * @throws ClassNotFoundException
-	 */
-	public static Message decode(byte[] buf) throws IOException, ClassNotFoundException {
-		ByteArrayInputStream bas = new ByteArrayInputStream(buf);
-		ObjectInputStream ois = new ObjectInputStream(bas);
-		return (Message) ois.readObject();
-	}
-
-	/**
-	 * 将对象转为二进制数据
-	 *
-	 * @param message
-	 * @return
-	 */
-	public static byte[] encode(Message message) throws IOException {
-		ByteArrayOutputStream baos = new ByteArrayOutputStream();
-		ObjectOutputStream oos = new ObjectOutputStream(baos);
-		oos.writeObject(message);
-		oos.flush();
-		return baos.toByteArray();
-	}
-}
-
Index: Server/src/main/java/com/lkw/server/Server/NioClient.java
===================================================================
diff --git a/Server/src/main/java/com/lkw/server/Server/NioClient.java b/Server/src/main/java/com/lkw/server/Server/NioClient.java
deleted file mode 100644
--- a/Server/src/main/java/com/lkw/server/Server/NioClient.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ /dev/null	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
@@ -1,116 +0,0 @@
-package com.lkw.server.Server;
-
-
-
-import com.lkw.server.Utils.Message;
-import com.lkw.server.Utils.Utils;
-import lombok.extern.slf4j.Slf4j;
-
-import java.io.IOException;
-import java.net.InetSocketAddress;
-import java.nio.ByteBuffer;
-import java.nio.channels.SelectionKey;
-import java.nio.channels.Selector;
-import java.nio.channels.SocketChannel;
-import java.util.Iterator;
-import java.util.Scanner;
-
-import static com.lkw.server.Utils.FinalValue.*;
-
-
-/**
- * @author mazouri
- * @create 2021-04-29 12:02
- */
-@Slf4j
-public class NioClient {
-	private Selector selector;
-	private SocketChannel socketChannel;
-	private String username;
-	private static Scanner input;
-
-	public NioClient() throws IOException {
-		selector = Selector.open();
-		socketChannel = SocketChannel.open(new InetSocketAddress("127.0.0.1", 8888));
-		socketChannel.configureBlocking(false);
-		socketChannel.register(selector, SelectionKey.OP_READ);
-		log. info("client启动完成......");
-		log. info("请输入你的名字完成注册");
-		input = new Scanner(System.in);
-		username = input.next();
-		log. info("欢迎{}来到聊天系统", username);
-	}
-
-	public static void main(String[] args) throws IOException {
-		System.out.println("tips: \n" +
-				"1. 直接发送消息会发给当前的所有用户 \n" +
-				"2. @用户名:消息  会私发给你要发送的用户 \n" +
-				"3. 输入  查询在线用户  会显示当前的在线用户");
-		NioClient client = new NioClient();
-
-		//启动一个子线程接受服务器发送过来的消息
-		new Thread(() -> {
-			try {
-				client.acceptMessageFromServer();
-			} catch (Exception e) {
-				e.printStackTrace();
-			}
-		}, "receiveClientThread").start();
-
-		//调用sendMessageToServer,发送消息到服务端
-		client.sendMessageToServer();
-	}
-
-	/**
-	 * 将消息发送到服务端
-	 *
-	 * @throws IOException
-	 */
-	private void sendMessageToServer() throws IOException {
-		//先把用户名发给客户端
-		Message message = new Message(MSG_NAME, username);
-		byte[] bytes = Utils.encode(message);
-
-		socketChannel.write(ByteBuffer.wrap(bytes));
-		while (input.hasNextLine()) {
-			String msgStr = input.next();
-
-			Message msg;
-			boolean isPrivate = msgStr.startsWith("@");
-			if (isPrivate) {
-				int idx = msgStr.indexOf(":");
-				String targetName = msgStr.substring(1, idx);
-				msgStr = msgStr.substring(idx + 1);
-				msg = new Message(MSG_PRIVATE, targetName + "_" + msgStr);
-			} else if ("查询在线用户".equals(msgStr)) {
-				msg = new Message(MSG_ONLINE, "请求在线人数");
-			} else {
-				msg = new Message(MSG_GROUP, msgStr);
-			}
-
-			byte[] bytes1 = Utils.encode(msg);
-			socketChannel.write(ByteBuffer.wrap(bytes1));
-		}
-	}
-
-	/**
-	 * 接受从服务器发送过来的消息
-	 */
-	private void acceptMessageFromServer() throws Exception {
-		while (selector.select() > 0) {
-			Iterator<SelectionKey> iterator = selector.selectedKeys().iterator();
-			while (iterator.hasNext()) {
-				SelectionKey key = iterator.next();
-				iterator.remove();
-				if (key.isReadable()) {
-					SocketChannel sc = (SocketChannel) key.channel();
-					ByteBuffer buffer = ByteBuffer.allocate(1024);
-					sc.read(buffer);
-					Message message = Utils.decode(buffer.array());
-					log. info(String.valueOf(message.message));
-				}
-			}
-		}
-	}
-}
-
Index: Client/src/main/java/com/lkw/client/Utils/Utils.java
===================================================================
diff --git a/Client/src/main/java/com/lkw/client/Utils/Utils.java b/Client/src/main/java/com/lkw/client/Utils/Utils.java
deleted file mode 100644
--- a/Client/src/main/java/com/lkw/client/Utils/Utils.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ /dev/null	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
@@ -1,41 +0,0 @@
-package com.lkw.client.Utils;
-
-import lombok.extern.slf4j.Slf4j;
-
-import java.io.*;
-
-/**
- * @author mazouri
- * @create 2021-05-09 22:26
- */
-@Slf4j
-public class Utils {
-	/**
-	 * 将二进制数据转为对象
-	 *
-	 * @param buf
-	 * @return
-	 * @throws IOException
-	 * @throws ClassNotFoundException
-	 */
-	public static Message decode(byte[] buf) throws IOException, ClassNotFoundException {
-		ByteArrayInputStream bais = new ByteArrayInputStream(buf);
-		ObjectInputStream ois = new ObjectInputStream(bais);
-		return (Message) ois.readObject();
-	}
-
-	/**
-	 * 将对象转为二进制数据
-	 *
-	 * @param message
-	 * @return
-	 */
-	public static byte[] encode(Message message) throws IOException {
-		ByteArrayOutputStream baos = new ByteArrayOutputStream();
-		ObjectOutputStream oos = new ObjectOutputStream(baos);
-		oos.writeObject(message);
-		oos.flush();
-		return baos.toByteArray();
-	}
-}
-
Index: Client/Client.iml
===================================================================
diff --git a/Client/Client.iml b/Client/Client.iml
deleted file mode 100644
--- a/Client/Client.iml	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ /dev/null	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
@@ -1,2 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<module type="JAVA_MODULE" version="4" />
Index: Server/src/main/java/com/lkw/server/Utils/FinalValue.java
===================================================================
diff --git a/Server/src/main/java/com/lkw/server/Utils/FinalValue.java b/Server/src/main/java/com/lkw/server/Utils/FinalValue.java
deleted file mode 100644
--- a/Server/src/main/java/com/lkw/server/Utils/FinalValue.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ /dev/null	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
@@ -1,40 +0,0 @@
-package com.lkw.server.Utils;
-
-/**
- * @author mazouri
- * @create 2021-05-05 21:00
- */
-public final class FinalValue {
-	/**
-	 * 系统消息
-	 */
-	public static final int MSG_SYSTEM = 0;
-	/**
-	 * 群发消息
-	 */
-	public static final int MSG_GROUP = 1;
-	/**
-	 * 私发消息
-	 */
-	public static final int MSG_PRIVATE = 2;
-	/**
-	 * 客户端请求在线人员
-	 */
-	public static final int MSG_ONLINE = 3;
-	/**
-	 * 客户端将用户名称发送给服务端
-	 */
-	public static final int MSG_NAME = 4;
-	/**
-	 * 客户端请求发送文件
-	 */
-	public static final int MSG_SentFile = 5;
-	/**
-	 * 客户端请求读取文件
-	 */
-	public static final int MSG_GetFile = 6;
-	/**
-	 * 文件消息
-	 */
-	public static final int MSG_File = 7;
-}
Index: Server/src/main/java/com/lkw/server/Utils/Message.java
===================================================================
diff --git a/Server/src/main/java/com/lkw/server/Utils/Message.java b/Server/src/main/java/com/lkw/server/Utils/Message.java
deleted file mode 100644
--- a/Server/src/main/java/com/lkw/server/Utils/Message.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ /dev/null	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
@@ -1,36 +0,0 @@
-package com.lkw.server.Utils;
-
-import java.io.Serializable;
-import java.nio.file.Files;
-
-/**
- * @author mazouri
- * @create 2021-05-05 21:00
- */
-public class Message implements Serializable {
-	public int type;
-	public String SendUser;
-	public String message;
-
-	public Message() {
-
-	}
-
-	public Message(String message) {
-		this.message = message;
-	}
-
-	public Message(int type, String message) {
-		this.type = type;
-		this.message = message;
-	}
-
-	@Override
-	public String toString() {
-		return "Message{" +
-				"type=" + type +
-				", message='" + message + '\'' +
-				'}';
-	}
-}
-
Index: Client/src/main/java/com/lkw/client/Utils/Message.java
===================================================================
diff --git a/Client/src/main/java/com/lkw/client/Utils/Message.java b/Client/src/main/java/com/lkw/client/Utils/Message.java
deleted file mode 100644
--- a/Client/src/main/java/com/lkw/client/Utils/Message.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ /dev/null	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
@@ -1,33 +0,0 @@
-package com.lkw.client.Utils;
-
-import java.io.Serializable;
-
-/**
- * @author mazouri
- * @create 2021-05-05 21:00
- */
-public class Message implements Serializable {
-	public int type;
-	public String message;
-
-	public Message() {
-	}
-
-	public Message(String message) {
-		this.message = message;
-	}
-
-	public Message(int type, String message) {
-		this.type = type;
-		this.message = message;
-	}
-
-	@Override
-	public String toString() {
-		return "Message{" +
-				"type=" + type +
-				", message='" + message + '\'' +
-				'}';
-	}
-}
-
Index: Client/src/main/java/com/lkw/client/Utils/Json2Object.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.lkw.client.Utils;\r\n\r\nimport com.alibaba.fastjson2.JSONObject;\r\nimport lombok.Data;\r\n\r\nimport javax.jws.WebParam;\r\n\r\n@Data\r\npublic class Json2Object {\r\n    private  String username;\r\n\r\n\r\n    private  int type;\r\n    private String message;\r\n\r\n\r\n    private String mode;\r\n\r\n    private JSONObject data;\r\n\r\n\r\n\r\n    public  Json2Object(String json){\r\n        //转换传输的消息格式\r\n        //格式   json:{\"username\":\"lkw\",\"mode\":1,\"data\":{\"text\":\"lkw111111111\"}}\r\n        //格式2 {\"type\":2,\"message\":....}\r\n        JSONObject jsonObject = JSONObject.parseObject(json);\r\n        setType((int)jsonObject.get(\"type\"));\r\n        setMessage((String) jsonObject.get(\"message\"));\r\n        // this.setMode((String) jsonObject.get(\"mode\"));\r\n        // this.setUsername((String)jsonObject.get(\"username\"));\r\n        // this.setData(jsonObject.getJSONObject(\"data\"));\r\n    }\r\n\r\n    public  String Json2Text() {\r\n        //得到text对应的键值对的值\r\n            return (String) this.data.get(\"text\");\r\n    }\r\n\r\n    public boolean Json2logged() {\r\n        //获取键\"logged\"对应的值\r\n        return (boolean) this.data.get(\"logged\");\r\n    }\r\n    //TODO 其他mode情况的解析json方法,按照上面的模仿\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    public String getUsername() {\r\n        return username;\r\n    }\r\n\r\n    public void setUsername(String username) {\r\n        this.username = username;\r\n    }\r\n\r\n    public String getMode() {\r\n        return mode;\r\n    }\r\n\r\n    public void setMode(String mode) {\r\n        this.mode = mode;\r\n    }\r\n\r\n    public JSONObject getData() {\r\n        return data;\r\n    }\r\n\r\n    public void setData(JSONObject data) {\r\n        this.data = data;\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/Client/src/main/java/com/lkw/client/Utils/Json2Object.java b/Client/src/main/java/com/lkw/client/Utils/Json2Object.java
--- a/Client/src/main/java/com/lkw/client/Utils/Json2Object.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ b/Client/src/main/java/com/lkw/client/Utils/Json2Object.java	(date 1668666942392)
@@ -1,19 +1,12 @@
 package com.lkw.client.Utils;
 
 import com.alibaba.fastjson2.JSONObject;
-import lombok.Data;
 
 import javax.jws.WebParam;
 
-@Data
 public class Json2Object {
     private  String username;
 
-
-    private  int type;
-    private String message;
-
-
     private String mode;
 
     private JSONObject data;
@@ -23,13 +16,10 @@
     public  Json2Object(String json){
         //转换传输的消息格式
         //格式   json:{"username":"lkw","mode":1,"data":{"text":"lkw111111111"}}
-        //格式2 {"type":2,"message":....}
         JSONObject jsonObject = JSONObject.parseObject(json);
-        setType((int)jsonObject.get("type"));
-        setMessage((String) jsonObject.get("message"));
-        // this.setMode((String) jsonObject.get("mode"));
-        // this.setUsername((String)jsonObject.get("username"));
-        // this.setData(jsonObject.getJSONObject("data"));
+        this.setMode((String) jsonObject.get("mode"));
+        this.setUsername((String)jsonObject.get("username"));
+        this.setData(jsonObject.getJSONObject("data"));
     }
 
     public  String Json2Text() {
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ArtifactsWorkspaceSettings\">\r\n    <artifacts-to-build>\r\n      <artifact name=\"Client:jar\" />\r\n    </artifacts-to-build>\r\n  </component>\r\n  <component name=\"AutoImportSettings\">\r\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\r\n  </component>\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"3cea0fed-dc54-4249-a389-a55d229ef605\" name=\"Changes\" comment=\"服务器传送消息改为NIO模式 &#10;服务器的传送文件还差具体实现,流程应该已经完善&#10;   --shaw\">\r\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Controller/LoginController.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Controller/LoginController.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Thread/MyClientThread.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Thread/MyClientThread.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Utils/Json2Object.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Utils/Json2Object.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/Server/src/main/java/com/lkw/server/FileServer/MyFileServer.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/Server/src/main/java/com/lkw/server/FileServer/MyFileServer.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/MyServer.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/MyServer.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Utils/Message.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Utils/Message.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/pom.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/pom.xml\" afterDir=\"false\" />\r\n    </list>\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"FileTemplateManagerImpl\">\r\n    <option name=\"RECENT_TEMPLATES\">\r\n      <list>\r\n        <option value=\"Class\" />\r\n      </list>\r\n    </option>\r\n  </component>\r\n  <component name=\"Git.Pull.Settings\">\r\n    <option name=\"OPTIONS\">\r\n      <set>\r\n        <option value=\"REBASE\" />\r\n      </set>\r\n    </option>\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n    <option name=\"RESET_MODE\" value=\"HARD\" />\r\n  </component>\r\n  <component name=\"MarkdownSettingsMigration\">\r\n    <option name=\"stateVersion\" value=\"1\" />\r\n  </component>\r\n  <component name=\"ProblemsViewState\">\r\n    <option name=\"selectedTabId\" value=\"CurrentFile\" />\r\n  </component>\r\n  <component name=\"ProjectId\" id=\"2F6M1wAhtbG0LxT4tE4zrIoP6u8\" />\r\n  <component name=\"ProjectLevelVcsManager\" settingsEditedManually=\"true\" />\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\">\r\n    <property name=\"WebServerToolWindowFactoryState\" value=\"false\" />\r\n    <property name=\"aspect.path.notification.shown\" value=\"true\" />\r\n    <property name=\"last_opened_file_path\" value=\"$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Utils\" />\r\n    <property name=\"project.structure.last.edited\" value=\"Modules\" />\r\n    <property name=\"project.structure.proportion\" value=\"0.1112347\" />\r\n    <property name=\"project.structure.side.proportion\" value=\"0.24937344\" />\r\n    <property name=\"run.code.analysis.last.selected.profile\" value=\"pProject Default\" />\r\n    <property name=\"vue.rearranger.settings.migration\" value=\"true\" />\r\n  </component>\r\n  <component name=\"RecentsManager\">\r\n    <key name=\"CreateClassDialog.RecentsKey\">\r\n      <recent name=\"com.lkw.client.Controller\" />\r\n    </key>\r\n    <key name=\"CopyFile.RECENT_KEYS\">\r\n      <recent name=\"D:\\CodeOfJava\\NetWorkSubject\\QQ_Chat_imitate\\Server\\src\\main\\java\\com\\lkw\\server\\Utils\" />\r\n      <recent name=\"D:\\work\\javacode\\QQ_Chat\\Server\\src\\main\\java\\com\\lkw\\server\" />\r\n      <recent name=\"D:\\work\\javacode\\QQ_Chat\\Server\\src\\test\\java\\com\\lkw\\server\" />\r\n      <recent name=\"D:\\work\\javacode\\QQ_Chat\\Client\\src\\main\\resources\" />\r\n      <recent name=\"D:\\work\\javacode\\QQ_Chat\\Client\\src\\main\\java\\com\\lkw\\client\\Controller\" />\r\n    </key>\r\n    <key name=\"MoveFile.RECENT_KEYS\">\r\n      <recent name=\"D:\\work\\javacode\\QQ_Chat\\src\\main\\resources\" />\r\n      <recent name=\"D:\\work\\javacode\\QQ_Chat\\src\\main\\java\\org\\lkw\" />\r\n    </key>\r\n    <key name=\"CopyClassDialog.RECENTS_KEY\">\r\n      <recent name=\"com.lkw.server.Server\" />\r\n      <recent name=\"com.lkw.client\" />\r\n      <recent name=\"com.lkw.client.Client\" />\r\n      <recent name=\"com.lkw.server\" />\r\n      <recent name=\"com.lkw.client.Controller\" />\r\n    </key>\r\n  </component>\r\n  <component name=\"RunDashboard\">\r\n    <option name=\"configurationTypes\">\r\n      <set>\r\n        <option value=\"SpringBootApplicationConfigurationType\" />\r\n      </set>\r\n    </option>\r\n  </component>\r\n  <component name=\"RunManager\" selected=\"Application.Main\">\r\n    <configuration name=\"Login\" type=\"Application\" factoryName=\"Application\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"com.lkw.client.Login\" />\r\n      <module name=\"Client\" />\r\n      <extension name=\"coverage\">\r\n        <pattern>\r\n          <option name=\"PATTERN\" value=\"com.lkw.client.*\" />\r\n          <option name=\"ENABLED\" value=\"true\" />\r\n        </pattern>\r\n      </extension>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"Main\" type=\"Application\" factoryName=\"Application\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"com.lkw.client.Main\" />\r\n      <module name=\"Client\" />\r\n      <extension name=\"coverage\">\r\n        <pattern>\r\n          <option name=\"PATTERN\" value=\"com.lkw.client.*\" />\r\n          <option name=\"ENABLED\" value=\"true\" />\r\n        </pattern>\r\n      </extension>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"NioClient (1)\" type=\"Application\" factoryName=\"Application\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"com.lkw.server.Server.NioClient\" />\r\n      <module name=\"Server\" />\r\n      <extension name=\"coverage\">\r\n        <pattern>\r\n          <option name=\"PATTERN\" value=\"com.lkw.server.Server.*\" />\r\n          <option name=\"ENABLED\" value=\"true\" />\r\n        </pattern>\r\n      </extension>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"NioClient\" type=\"Application\" factoryName=\"Application\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"com.lkw.client.NioClient\" />\r\n      <module name=\"Client\" />\r\n      <extension name=\"coverage\">\r\n        <pattern>\r\n          <option name=\"PATTERN\" value=\"com.lkw.client.*\" />\r\n          <option name=\"ENABLED\" value=\"true\" />\r\n        </pattern>\r\n      </extension>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"NioClient\" type=\"Application\" factoryName=\"Application\" singleton=\"false\" nameIsGenerated=\"true\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"com.lkw.server.Server.NioClient\" />\r\n      <module name=\"Server\" />\r\n      <extension name=\"coverage\">\r\n        <pattern>\r\n          <option name=\"PATTERN\" value=\"com.lkw.server.Server.*\" />\r\n          <option name=\"ENABLED\" value=\"true\" />\r\n        </pattern>\r\n      </extension>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"ServerUI\" type=\"Application\" factoryName=\"Application\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"com.lkw.server.ServerUI\" />\r\n      <module name=\"Server\" />\r\n      <extension name=\"coverage\">\r\n        <pattern>\r\n          <option name=\"PATTERN\" value=\"com.lkw.server.Server.*\" />\r\n          <option name=\"ENABLED\" value=\"true\" />\r\n        </pattern>\r\n      </extension>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration default=\"true\" type=\"ArquillianJUnit\" factoryName=\"\" nameIsGenerated=\"true\">\r\n      <option name=\"arquillianRunConfiguration\">\r\n        <value>\r\n          <option name=\"containerStateName\" value=\"\" />\r\n        </value>\r\n      </option>\r\n      <option name=\"TEST_OBJECT\" value=\"class\" />\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"ClientApplication\" type=\"SpringBootApplicationConfigurationType\" factoryName=\"Spring Boot\">\r\n      <module name=\"Client\" />\r\n      <option name=\"SPRING_BOOT_MAIN_CLASS\" value=\"com.lkw.client.ClientApplication\" />\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"ServerApplication\" type=\"SpringBootApplicationConfigurationType\" factoryName=\"Spring Boot\">\r\n      <module name=\"Server\" />\r\n      <option name=\"SPRING_BOOT_MAIN_CLASS\" value=\"com.lkw.server.ServerApplication\" />\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <recent_temporary>\r\n      <list>\r\n        <item itemvalue=\"Application.Main\" />\r\n        <item itemvalue=\"Application.NioClient (1)\" />\r\n        <item itemvalue=\"Application.ServerUI\" />\r\n        <item itemvalue=\"Application.NioClient\" />\r\n        <item itemvalue=\"Application.Login\" />\r\n      </list>\r\n    </recent_temporary>\r\n  </component>\r\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\r\n  <component name=\"TaskManager\">\r\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\r\n      <changelist id=\"3cea0fed-dc54-4249-a389-a55d229ef605\" name=\"Changes\" comment=\"\" />\r\n      <created>1663807871194</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1663807871194</updated>\r\n      <workItem from=\"1663807873290\" duration=\"6592000\" />\r\n      <workItem from=\"1663849790758\" duration=\"396000\" />\r\n      <workItem from=\"1663944857158\" duration=\"615000\" />\r\n      <workItem from=\"1663984770061\" duration=\"2267000\" />\r\n      <workItem from=\"1664082197102\" duration=\"953000\" />\r\n      <workItem from=\"1664366066395\" duration=\"2760000\" />\r\n      <workItem from=\"1665047611842\" duration=\"9325000\" />\r\n      <workItem from=\"1665066580048\" duration=\"153000\" />\r\n      <workItem from=\"1665066770623\" duration=\"804000\" />\r\n      <workItem from=\"1665574539989\" duration=\"396000\" />\r\n      <workItem from=\"1665803686964\" duration=\"7484000\" />\r\n      <workItem from=\"1665850707539\" duration=\"31000\" />\r\n      <workItem from=\"1665919383861\" duration=\"31351000\" />\r\n      <workItem from=\"1666018389675\" duration=\"5451000\" />\r\n      <workItem from=\"1666149982164\" duration=\"1285000\" />\r\n      <workItem from=\"1666242310918\" duration=\"955000\" />\r\n      <workItem from=\"1666246288076\" duration=\"6000\" />\r\n      <workItem from=\"1666264228301\" duration=\"322000\" />\r\n      <workItem from=\"1666265729704\" duration=\"3930000\" />\r\n      <workItem from=\"1666779287165\" duration=\"286000\" />\r\n      <workItem from=\"1666779597701\" duration=\"8670000\" />\r\n      <workItem from=\"1667202209829\" duration=\"1873000\" />\r\n      <workItem from=\"1667277759604\" duration=\"59000\" />\r\n      <workItem from=\"1667383971848\" duration=\"1316000\" />\r\n      <workItem from=\"1667390177544\" duration=\"702000\" />\r\n      <workItem from=\"1667395638524\" duration=\"3114000\" />\r\n      <workItem from=\"1667440465482\" duration=\"233000\" />\r\n      <workItem from=\"1667443928735\" duration=\"12310000\" />\r\n      <workItem from=\"1667523540428\" duration=\"8000\" />\r\n      <workItem from=\"1667559726989\" duration=\"12000\" />\r\n      <workItem from=\"1667612398360\" duration=\"12160000\" />\r\n      <workItem from=\"1668337106312\" duration=\"47837000\" />\r\n      <workItem from=\"1668581099009\" duration=\"22000\" />\r\n      <workItem from=\"1668593095422\" duration=\"21958000\" />\r\n    </task>\r\n    <task id=\"LOCAL-00001\" summary=\"基础代码\">\r\n      <created>1663814396212</created>\r\n      <option name=\"number\" value=\"00001\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00001\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1663814396212</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00002\" summary=\"添加javafx图形界面,能打开,但是不能用\">\r\n      <created>1663988018847</created>\r\n      <option name=\"number\" value=\"00002\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00002\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1663988018847</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00003\" summary=\"添加springboot,&#10;页面跳转逻辑完成\">\r\n      <created>1665065496855</created>\r\n      <option name=\"number\" value=\"00003\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00003\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1665065496855</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00004\" summary=\"添加springboot,&#10;页面跳转逻辑完成\">\r\n      <created>1665066371601</created>\r\n      <option name=\"number\" value=\"00004\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00004\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1665066371601</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00005\" summary=\"添加springboot,&#10;页面跳转逻辑完成\">\r\n      <created>1665066810364</created>\r\n      <option name=\"number\" value=\"00005\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00005\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1665066810364</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00006\" summary=\"添加部分页面逻辑\">\r\n      <created>1665831271079</created>\r\n      <option name=\"number\" value=\"00006\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00006\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1665831271079</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00007\" summary=\"添加socket,但是比较乱\">\r\n      <created>1666779434975</created>\r\n      <option name=\"number\" value=\"00007\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00007\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1666779434975</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00008\" summary=\"添加socket,但是比较乱\">\r\n      <created>1666779610566</created>\r\n      <option name=\"number\" value=\"00008\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00008\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1666779610566</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00009\" summary=\"添加文件上传\">\r\n      <created>1667628373417</created>\r\n      <option name=\"number\" value=\"00009\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00009\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1667628373417</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00010\" summary=\"文件上传合并\">\r\n      <created>1667634073245</created>\r\n      <option name=\"number\" value=\"00010\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00010\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1667634073245</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00011\" summary=\"文件上传合并\">\r\n      <created>1667634118154</created>\r\n      <option name=\"number\" value=\"00011\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00011\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1667634118154</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00012\" summary=\"完成文件发送接收,文本发送修改为json传送,更好拓展\">\r\n      <created>1668407412346</created>\r\n      <option name=\"number\" value=\"00012\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00012\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668407412346</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00013\" summary=\"完成文件发送接收,文本发送修改为json传送,更好拓展\">\r\n      <created>1668407457644</created>\r\n      <option name=\"number\" value=\"00013\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00013\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668407457644</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00014\" summary=\"服务器传送消息改为NIO模式 &#10;服务器的传送文件还差具体实现,流程应该已经完善&#10;   --shaw\">\r\n      <created>1668608710096</created>\r\n      <option name=\"number\" value=\"00014\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00014\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668608710096</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00015\" summary=\"服务器传送消息改为NIO模式 &#10;服务器的传送文件还差具体实现,流程应该已经完善&#10;   --shaw\">\r\n      <created>1668608759226</created>\r\n      <option name=\"number\" value=\"00015\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00015\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1668608759226</updated>\r\n    </task>\r\n    <option name=\"localTasksCounter\" value=\"16\" />\r\n    <servers />\r\n  </component>\r\n  <component name=\"TypeScriptGeneratedFilesManager\">\r\n    <option name=\"version\" value=\"3\" />\r\n  </component>\r\n  <component name=\"Vcs.Log.History.Properties\">\r\n    <option name=\"COLUMN_ID_ORDER\">\r\n      <list>\r\n        <option value=\"Default.Root\" />\r\n        <option value=\"Default.Author\" />\r\n        <option value=\"Default.Date\" />\r\n        <option value=\"Default.Subject\" />\r\n        <option value=\"Space.CommitStatus\" />\r\n      </list>\r\n    </option>\r\n  </component>\r\n  <component name=\"Vcs.Log.Tabs.Properties\">\r\n    <option name=\"TAB_STATES\">\r\n      <map>\r\n        <entry key=\"MAIN\">\r\n          <value>\r\n            <State>\r\n              <option name=\"FILTERS\">\r\n                <map>\r\n                  <entry key=\"branch\">\r\n                    <value>\r\n                      <list>\r\n                        <option value=\"master\" />\r\n                      </list>\r\n                    </value>\r\n                  </entry>\r\n                </map>\r\n              </option>\r\n            </State>\r\n          </value>\r\n        </entry>\r\n      </map>\r\n    </option>\r\n    <option name=\"oldMeFiltersMigrated\" value=\"true\" />\r\n  </component>\r\n  <component name=\"VcsManagerConfiguration\">\r\n    <ignored-roots>\r\n      <path value=\"$PROJECT_DIR$/Client\" />\r\n      <path value=\"$PROJECT_DIR$/Server\" />\r\n      <path value=\"$PROJECT_DIR$\" />\r\n    </ignored-roots>\r\n    <MESSAGE value=\"基础代码\" />\r\n    <MESSAGE value=\"添加javafx图形界面,能打开,但是不能用\" />\r\n    <MESSAGE value=\"添加springboot,&#10;页面跳转逻辑完成\" />\r\n    <MESSAGE value=\"添加部分页面逻辑\" />\r\n    <MESSAGE value=\"添加socket,但是比较乱\" />\r\n    <MESSAGE value=\"添加文件上传\" />\r\n    <MESSAGE value=\"文件上传合并\" />\r\n    <MESSAGE value=\"完成文件发送接收,文本发送修改为json传送,更好拓展\" />\r\n    <MESSAGE value=\"服务器传送消息改为NIO模式 &#10;服务器的传送文件还差具体实现,流程应该已经完善&#10;   --shaw\" />\r\n    <option name=\"LAST_COMMIT_MESSAGE\" value=\"服务器传送消息改为NIO模式 &#10;服务器的传送文件还差具体实现,流程应该已经完善&#10;   --shaw\" />\r\n  </component>\r\n  <component name=\"XDebuggerManager\">\r\n    <breakpoint-manager>\r\n      <breakpoints>\r\n        <line-breakpoint enabled=\"true\" type=\"java-line\">\r\n          <url>file://$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Controller/LoginController.java</url>\r\n          <line>80</line>\r\n          <option name=\"timeStamp\" value=\"47\" />\r\n        </line-breakpoint>\r\n        <line-breakpoint enabled=\"true\" type=\"java-line\">\r\n          <url>file://$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/MyServer.java</url>\r\n          <line>278</line>\r\n          <option name=\"timeStamp\" value=\"52\" />\r\n        </line-breakpoint>\r\n        <line-breakpoint enabled=\"true\" type=\"java-line\">\r\n          <url>file://$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/MyServer.java</url>\r\n          <line>164</line>\r\n          <option name=\"timeStamp\" value=\"53\" />\r\n        </line-breakpoint>\r\n        <line-breakpoint enabled=\"true\" type=\"java-line\">\r\n          <url>file://$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/MyServer.java</url>\r\n          <line>272</line>\r\n          <option name=\"timeStamp\" value=\"56\" />\r\n        </line-breakpoint>\r\n        <line-breakpoint enabled=\"true\" type=\"java-line\">\r\n          <url>file://$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/MyServer.java</url>\r\n          <line>202</line>\r\n          <option name=\"timeStamp\" value=\"57\" />\r\n        </line-breakpoint>\r\n      </breakpoints>\r\n    </breakpoint-manager>\r\n  </component>\r\n  <component name=\"XSLT-Support.FileAssociations.UIState\">\r\n    <expand />\r\n    <select />\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ b/.idea/workspace.xml	(date 1668738869770)
@@ -9,15 +9,36 @@
     <option name="autoReloadType" value="SELECTIVE" />
   </component>
   <component name="ChangeListManager">
-    <list default="true" id="3cea0fed-dc54-4249-a389-a55d229ef605" name="Changes" comment="服务器传送消息改为NIO模式 &#10;服务器的传送文件还差具体实现,流程应该已经完善&#10;   --shaw">
+    <list default="true" id="3cea0fed-dc54-4249-a389-a55d229ef605" name="Changes" comment="lkw测试">
+      <change afterPath="$PROJECT_DIR$/Server/HELP.md" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/Server/mvnw" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/Server/mvnw.cmd" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/handler.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/.idea/compiler.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/compiler.xml" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/Client/Client.iml" beforeDir="false" />
+      <change beforePath="$PROJECT_DIR$/Client/pom.xml" beforeDir="false" afterPath="$PROJECT_DIR$/Client/pom.xml" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Controller/LoginController.java" beforeDir="false" afterPath="$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Controller/LoginController.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Main.java" beforeDir="false" afterPath="$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Main.java" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Thread/MyClientThread.java" beforeDir="false" afterPath="$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Thread/MyClientThread.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Utils/FinalValue.java" beforeDir="false" />
       <change beforePath="$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Utils/Json2Object.java" beforeDir="false" afterPath="$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Utils/Json2Object.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Utils/Message.java" beforeDir="false" />
+      <change beforePath="$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Utils/Utils.java" beforeDir="false" />
+      <change beforePath="$PROJECT_DIR$/Client/target/classes/com/lkw/client/Main.class" beforeDir="false" afterPath="$PROJECT_DIR$/Client/target/classes/com/lkw/client/Main.class" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/Client/target/classes/com/lkw/client/Thread/MyClientThread.class" beforeDir="false" afterPath="$PROJECT_DIR$/Client/target/classes/com/lkw/client/Thread/MyClientThread.class" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/Server/pom.xml" beforeDir="false" afterPath="$PROJECT_DIR$/Server/pom.xml" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/FileServer/MyFileServer.java" beforeDir="false" afterPath="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/FileServer/MyFileServer.java" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/MyServer.java" beforeDir="false" afterPath="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/MyServer.java" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Utils/Message.java" beforeDir="false" afterPath="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Utils/Message.java" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/pom.xml" beforeDir="false" afterPath="$PROJECT_DIR$/pom.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/NioClient.java" beforeDir="false" />
+      <change beforePath="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/ServerUI.java" beforeDir="false" afterPath="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/ServerUI.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Utils/FinalValue.java" beforeDir="false" />
+      <change beforePath="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Utils/Message.java" beforeDir="false" />
+      <change beforePath="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Utils/Utils.java" beforeDir="false" />
+      <change beforePath="$PROJECT_DIR$/Server/target/classes/com/lkw/server/FileServer/MyFileServer.class" beforeDir="false" afterPath="$PROJECT_DIR$/Server/target/classes/com/lkw/server/FileServer/MyFileServer.class" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/Server/target/classes/com/lkw/server/FileServer/fileHandler.class" beforeDir="false" afterPath="$PROJECT_DIR$/Server/target/classes/com/lkw/server/FileServer/fileHandler.class" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/Server/target/classes/com/lkw/server/ServerUI$1.class" beforeDir="false" afterPath="$PROJECT_DIR$/Server/target/classes/com/lkw/server/ServerUI$1.class" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/Server/target/classes/com/lkw/server/ServerUI.class" beforeDir="false" afterPath="$PROJECT_DIR$/Server/target/classes/com/lkw/server/ServerUI.class" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -54,16 +75,15 @@
     <option name="hideEmptyMiddlePackages" value="true" />
     <option name="showLibraryContents" value="true" />
   </component>
-  <component name="PropertiesComponent">
-    <property name="WebServerToolWindowFactoryState" value="false" />
-    <property name="aspect.path.notification.shown" value="true" />
-    <property name="last_opened_file_path" value="$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Utils" />
-    <property name="project.structure.last.edited" value="Modules" />
-    <property name="project.structure.proportion" value="0.1112347" />
-    <property name="project.structure.side.proportion" value="0.24937344" />
-    <property name="run.code.analysis.last.selected.profile" value="pProject Default" />
-    <property name="vue.rearranger.settings.migration" value="true" />
-  </component>
+  <component name="PropertiesComponent">{
+  &quot;keyToString&quot;: {
+    &quot;WebServerToolWindowFactoryState&quot;: &quot;false&quot;,
+    &quot;node.js.detected.package.eslint&quot;: &quot;true&quot;,
+    &quot;node.js.selected.package.eslint&quot;: &quot;(autodetect)&quot;,
+    &quot;node.js.selected.package.tslint&quot;: &quot;(autodetect)&quot;,
+    &quot;spring.configuration.checksum&quot;: &quot;587c446a63103530d5d08b0cda6169ec&quot;
+  }
+}</component>
   <component name="RecentsManager">
     <key name="CreateClassDialog.RecentsKey">
       <recent name="com.lkw.client.Controller" />
@@ -94,7 +114,18 @@
       </set>
     </option>
   </component>
-  <component name="RunManager" selected="Application.Main">
+  <component name="RunManager" selected="Application.Login">
+    <configuration default="true" type="ArquillianJUnit" factoryName="" nameIsGenerated="true">
+      <option name="arquillianRunConfiguration">
+        <value>
+          <option name="containerStateName" value="" />
+        </value>
+      </option>
+      <option name="TEST_OBJECT" value="class" />
+      <method v="2">
+        <option name="Make" enabled="true" />
+      </method>
+    </configuration>
     <configuration name="Login" type="Application" factoryName="Application" temporary="true" nameIsGenerated="true">
       <option name="MAIN_CLASS_NAME" value="com.lkw.client.Login" />
       <module name="Client" />
@@ -173,17 +204,6 @@
         <option name="Make" enabled="true" />
       </method>
     </configuration>
-    <configuration default="true" type="ArquillianJUnit" factoryName="" nameIsGenerated="true">
-      <option name="arquillianRunConfiguration">
-        <value>
-          <option name="containerStateName" value="" />
-        </value>
-      </option>
-      <option name="TEST_OBJECT" value="class" />
-      <method v="2">
-        <option name="Make" enabled="true" />
-      </method>
-    </configuration>
     <configuration name="ClientApplication" type="SpringBootApplicationConfigurationType" factoryName="Spring Boot">
       <module name="Client" />
       <option name="SPRING_BOOT_MAIN_CLASS" value="com.lkw.client.ClientApplication" />
@@ -200,11 +220,11 @@
     </configuration>
     <recent_temporary>
       <list>
-        <item itemvalue="Application.Main" />
-        <item itemvalue="Application.NioClient (1)" />
+        <item itemvalue="Application.Login" />
         <item itemvalue="Application.ServerUI" />
+        <item itemvalue="Application.NioClient (1)" />
+        <item itemvalue="Application.Main" />
         <item itemvalue="Application.NioClient" />
-        <item itemvalue="Application.Login" />
       </list>
     </recent_temporary>
   </component>
@@ -250,6 +270,8 @@
       <workItem from="1668337106312" duration="47837000" />
       <workItem from="1668581099009" duration="22000" />
       <workItem from="1668593095422" duration="21958000" />
+      <workItem from="1668691701284" duration="893000" />
+      <workItem from="1668694056315" duration="223000" />
     </task>
     <task id="LOCAL-00001" summary="基础代码">
       <created>1663814396212</created>
@@ -384,7 +406,7 @@
                   <entry key="branch">
                     <value>
                       <list>
-                        <option value="master" />
+                        <option value="origin/master" />
                       </list>
                     </value>
                   </entry>
@@ -395,7 +417,6 @@
         </entry>
       </map>
     </option>
-    <option name="oldMeFiltersMigrated" value="true" />
   </component>
   <component name="VcsManagerConfiguration">
     <ignored-roots>
@@ -419,28 +440,8 @@
       <breakpoints>
         <line-breakpoint enabled="true" type="java-line">
           <url>file://$PROJECT_DIR$/Client/src/main/java/com/lkw/client/Controller/LoginController.java</url>
-          <line>80</line>
+          <line>79</line>
           <option name="timeStamp" value="47" />
-        </line-breakpoint>
-        <line-breakpoint enabled="true" type="java-line">
-          <url>file://$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/MyServer.java</url>
-          <line>278</line>
-          <option name="timeStamp" value="52" />
-        </line-breakpoint>
-        <line-breakpoint enabled="true" type="java-line">
-          <url>file://$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/MyServer.java</url>
-          <line>164</line>
-          <option name="timeStamp" value="53" />
-        </line-breakpoint>
-        <line-breakpoint enabled="true" type="java-line">
-          <url>file://$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/MyServer.java</url>
-          <line>272</line>
-          <option name="timeStamp" value="56" />
-        </line-breakpoint>
-        <line-breakpoint enabled="true" type="java-line">
-          <url>file://$PROJECT_DIR$/Server/src/main/java/com/lkw/server/Server/MyServer.java</url>
-          <line>202</line>
-          <option name="timeStamp" value="57" />
         </line-breakpoint>
       </breakpoints>
     </breakpoint-manager>
Index: .idea/compiler.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"CompilerConfiguration\">\r\n    <annotationProcessing>\r\n      <profile default=\"true\" name=\"Default\" enabled=\"true\" />\r\n      <profile name=\"Maven default annotation processors profile\" enabled=\"true\">\r\n        <sourceOutputDir name=\"target/generated-sources/annotations\" />\r\n        <sourceTestOutputDir name=\"target/generated-test-sources/test-annotations\" />\r\n        <outputRelativeToContentRoot value=\"true\" />\r\n        <module name=\"Server\" />\r\n        <module name=\"Client\" />\r\n        <module name=\"QQ_Chat\" />\r\n      </profile>\r\n    </annotationProcessing>\r\n  </component>\r\n  <component name=\"JavacSettings\">\r\n    <option name=\"ADDITIONAL_OPTIONS_OVERRIDE\">\r\n      <module name=\"Client\" options=\"-parameters\" />\r\n      <module name=\"Server\" options=\"-parameters\" />\r\n    </option>\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/compiler.xml b/.idea/compiler.xml
--- a/.idea/compiler.xml	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ b/.idea/compiler.xml	(date 1668694066059)
@@ -9,7 +9,6 @@
         <outputRelativeToContentRoot value="true" />
         <module name="Server" />
         <module name="Client" />
-        <module name="QQ_Chat" />
       </profile>
     </annotationProcessing>
   </component>
Index: Server/pom.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\">\r\n    <parent>\r\n        <artifactId>QQ_Chat</artifactId>\r\n        <groupId>org.lkw</groupId>\r\n        <version>1.0-SNAPSHOT</version>\r\n    </parent>\r\n    <modelVersion>4.0.0</modelVersion>\r\n\r\n    <groupId>com.lkw</groupId>\r\n    <artifactId>Server</artifactId>\r\n    <version>0.0.1-SNAPSHOT</version>\r\n    <name>Server</name>\r\n    <description>Server</description>\r\n    <properties>\r\n        <java.version>1.8</java.version>\r\n    </properties>\r\n\r\n    <dependencies>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter</artifactId>\r\n        </dependency>\r\n\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-test</artifactId>\r\n            <scope>test</scope>\r\n        </dependency>\r\n\r\n        <dependency>\r\n            <groupId>com.alibaba.fastjson2</groupId>\r\n            <artifactId>fastjson2</artifactId>\r\n            <version>2.0.19</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.alibaba.fastjson2</groupId>\r\n            <artifactId>fastjson2</artifactId>\r\n            <version>2.0.19</version>\r\n            <scope>compile</scope>\r\n        </dependency>\r\n\r\n    </dependencies>\r\n\r\n    <build>\r\n        <plugins>\r\n            <plugin>\r\n                <groupId>org.springframework.boot</groupId>\r\n                <artifactId>spring-boot-maven-plugin</artifactId>\r\n            </plugin>\r\n        </plugins>\r\n    </build>\r\n\r\n</project>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/Server/pom.xml b/Server/pom.xml
--- a/Server/pom.xml	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ b/Server/pom.xml	(date 1668666871461)
@@ -1,13 +1,13 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
+    <modelVersion>4.0.0</modelVersion>
     <parent>
-        <artifactId>QQ_Chat</artifactId>
-        <groupId>org.lkw</groupId>
-        <version>1.0-SNAPSHOT</version>
+        <groupId>org.springframework.boot</groupId>
+        <artifactId>spring-boot-starter-parent</artifactId>
+        <version>2.7.4</version>
+        <relativePath/> <!-- lookup parent from repository -->
     </parent>
-    <modelVersion>4.0.0</modelVersion>
-
     <groupId>com.lkw</groupId>
     <artifactId>Server</artifactId>
     <version>0.0.1-SNAPSHOT</version>
@@ -16,7 +16,6 @@
     <properties>
         <java.version>1.8</java.version>
     </properties>
-
     <dependencies>
         <dependency>
             <groupId>org.springframework.boot</groupId>
@@ -29,16 +28,10 @@
             <scope>test</scope>
         </dependency>
 
-        <dependency>
-            <groupId>com.alibaba.fastjson2</groupId>
-            <artifactId>fastjson2</artifactId>
-            <version>2.0.19</version>
-        </dependency>
         <dependency>
             <groupId>com.alibaba.fastjson2</groupId>
             <artifactId>fastjson2</artifactId>
             <version>2.0.19</version>
-            <scope>compile</scope>
         </dependency>
 
     </dependencies>
Index: Server/src/main/java/com/lkw/server/FileServer/MyFileServer.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.lkw.server.FileServer;\r\n\r\nimport java.io.IOException;\r\nimport java.io.PrintWriter;\r\nimport java.net.ServerSocket;\r\nimport java.net.Socket;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\npublic class MyFileServer implements Runnable{\r\n\r\n    public static final int PORT = 9998;\r\n\r\n    Map<String, PrintWriter> map = new HashMap<>();\r\n\r\n\r\n    public MyFileServer() {\r\n        super();\r\n\r\n    }\r\n\r\n    @Override\r\n    public void run() {\r\n\r\n        ServerSocket server;\r\n        Socket socket;\r\n        try {\r\n            server = new ServerSocket(PORT);\r\n            while(true) {\r\n                socket = server.accept();\r\n                //一个客户端接入就启动一个handler线程去处理\r\n                System.out.println(\"启动myfileserver线程\");\r\n                new Thread(new FileHandler(map, socket)).start();\r\n            }\r\n        } catch (IOException e)\r\n        {\r\n            // TODO 自动生成的 catch 块\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/Server/src/main/java/com/lkw/server/FileServer/MyFileServer.java b/Server/src/main/java/com/lkw/server/FileServer/MyFileServer.java
--- a/Server/src/main/java/com/lkw/server/FileServer/MyFileServer.java	(revision e6edc178c5e8752f46870f71fc41157f526763d4)
+++ b/Server/src/main/java/com/lkw/server/FileServer/MyFileServer.java	(date 1668666871486)
@@ -32,8 +32,7 @@
                 System.out.println("启动myfileserver线程");
                 new Thread(new FileHandler(map, socket)).start();
             }
-        } catch (IOException e)
-        {
+        } catch (IOException e) {
             // TODO 自动生成的 catch 块
             e.printStackTrace();
         }
Index: Server/mvnw
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/Server/mvnw b/Server/mvnw
new file mode 100644
--- /dev/null	(date 1668666871396)
+++ b/Server/mvnw	(date 1668666871396)
@@ -0,0 +1,316 @@
+#!/bin/sh
+# ----------------------------------------------------------------------------
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#    https://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing,
+# software distributed under the License is distributed on an
+# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+# KIND, either express or implied.  See the License for the
+# specific language governing permissions and limitations
+# under the License.
+# ----------------------------------------------------------------------------
+
+# ----------------------------------------------------------------------------
+# Maven Start Up Batch script
+#
+# Required ENV vars:
+# ------------------
+#   JAVA_HOME - location of a JDK home dir
+#
+# Optional ENV vars
+# -----------------
+#   M2_HOME - location of maven2's installed home dir
+#   MAVEN_OPTS - parameters passed to the Java VM when running Maven
+#     e.g. to debug Maven itself, use
+#       set MAVEN_OPTS=-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000
+#   MAVEN_SKIP_RC - flag to disable loading of mavenrc files
+# ----------------------------------------------------------------------------
+
+if [ -z "$MAVEN_SKIP_RC" ] ; then
+
+  if [ -f /usr/local/etc/mavenrc ] ; then
+    . /usr/local/etc/mavenrc
+  fi
+
+  if [ -f /etc/mavenrc ] ; then
+    . /etc/mavenrc
+  fi
+
+  if [ -f "$HOME/.mavenrc" ] ; then
+    . "$HOME/.mavenrc"
+  fi
+
+fi
+
+# OS specific support.  $var _must_ be set to either true or false.
+cygwin=false;
+darwin=false;
+mingw=false
+case "`uname`" in
+  CYGWIN*) cygwin=true ;;
+  MINGW*) mingw=true;;
+  Darwin*) darwin=true
+    # Use /usr/libexec/java_home if available, otherwise fall back to /Library/Java/Home
+    # See https://developer.apple.com/library/mac/qa/qa1170/_index.html
+    if [ -z "$JAVA_HOME" ]; then
+      if [ -x "/usr/libexec/java_home" ]; then
+        export JAVA_HOME="`/usr/libexec/java_home`"
+      else
+        export JAVA_HOME="/Library/Java/Home"
+      fi
+    fi
+    ;;
+esac
+
+if [ -z "$JAVA_HOME" ] ; then
+  if [ -r /etc/gentoo-release ] ; then
+    JAVA_HOME=`java-config --jre-home`
+  fi
+fi
+
+if [ -z "$M2_HOME" ] ; then
+  ## resolve links - $0 may be a link to maven's home
+  PRG="$0"
+
+  # need this for relative symlinks
+  while [ -h "$PRG" ] ; do
+    ls=`ls -ld "$PRG"`
+    link=`expr "$ls" : '.*-> \(.*\)$'`
+    if expr "$link" : '/.*' > /dev/null; then
+      PRG="$link"
+    else
+      PRG="`dirname "$PRG"`/$link"
+    fi
+  done
+
+  saveddir=`pwd`
+
+  M2_HOME=`dirname "$PRG"`/..
+
+  # make it fully qualified
+  M2_HOME=`cd "$M2_HOME" && pwd`
+
+  cd "$saveddir"
+  # echo Using m2 at $M2_HOME
+fi
+
+# For Cygwin, ensure paths are in UNIX format before anything is touched
+if $cygwin ; then
+  [ -n "$M2_HOME" ] &&
+    M2_HOME=`cygpath --unix "$M2_HOME"`
+  [ -n "$JAVA_HOME" ] &&
+    JAVA_HOME=`cygpath --unix "$JAVA_HOME"`
+  [ -n "$CLASSPATH" ] &&
+    CLASSPATH=`cygpath --path --unix "$CLASSPATH"`
+fi
+
+# For Mingw, ensure paths are in UNIX format before anything is touched
+if $mingw ; then
+  [ -n "$M2_HOME" ] &&
+    M2_HOME="`(cd "$M2_HOME"; pwd)`"
+  [ -n "$JAVA_HOME" ] &&
+    JAVA_HOME="`(cd "$JAVA_HOME"; pwd)`"
+fi
+
+if [ -z "$JAVA_HOME" ]; then
+  javaExecutable="`which javac`"
+  if [ -n "$javaExecutable" ] && ! [ "`expr \"$javaExecutable\" : '\([^ ]*\)'`" = "no" ]; then
+    # readlink(1) is not available as standard on Solaris 10.
+    readLink=`which readlink`
+    if [ ! `expr "$readLink" : '\([^ ]*\)'` = "no" ]; then
+      if $darwin ; then
+        javaHome="`dirname \"$javaExecutable\"`"
+        javaExecutable="`cd \"$javaHome\" && pwd -P`/javac"
+      else
+        javaExecutable="`readlink -f \"$javaExecutable\"`"
+      fi
+      javaHome="`dirname \"$javaExecutable\"`"
+      javaHome=`expr "$javaHome" : '\(.*\)/bin'`
+      JAVA_HOME="$javaHome"
+      export JAVA_HOME
+    fi
+  fi
+fi
+
+if [ -z "$JAVACMD" ] ; then
+  if [ -n "$JAVA_HOME"  ] ; then
+    if [ -x "$JAVA_HOME/jre/sh/java" ] ; then
+      # IBM's JDK on AIX uses strange locations for the executables
+      JAVACMD="$JAVA_HOME/jre/sh/java"
+    else
+      JAVACMD="$JAVA_HOME/bin/java"
+    fi
+  else
+    JAVACMD="`\\unset -f command; \\command -v java`"
+  fi
+fi
+
+if [ ! -x "$JAVACMD" ] ; then
+  echo "Error: JAVA_HOME is not defined correctly." >&2
+  echo "  We cannot execute $JAVACMD" >&2
+  exit 1
+fi
+
+if [ -z "$JAVA_HOME" ] ; then
+  echo "Warning: JAVA_HOME environment variable is not set."
+fi
+
+CLASSWORLDS_LAUNCHER=org.codehaus.plexus.classworlds.launcher.Launcher
+
+# traverses directory structure from process work directory to filesystem root
+# first directory with .mvn subdirectory is considered project base directory
+find_maven_basedir() {
+
+  if [ -z "$1" ]
+  then
+    echo "Path not specified to find_maven_basedir"
+    return 1
+  fi
+
+  basedir="$1"
+  wdir="$1"
+  while [ "$wdir" != '/' ] ; do
+    if [ -d "$wdir"/.mvn ] ; then
+      basedir=$wdir
+      break
+    fi
+    # workaround for JBEAP-8937 (on Solaris 10/Sparc)
+    if [ -d "${wdir}" ]; then
+      wdir=`cd "$wdir/.."; pwd`
+    fi
+    # end of workaround
+  done
+  echo "${basedir}"
+}
+
+# concatenates all lines of a file
+concat_lines() {
+  if [ -f "$1" ]; then
+    echo "$(tr -s '\n' ' ' < "$1")"
+  fi
+}
+
+BASE_DIR=`find_maven_basedir "$(pwd)"`
+if [ -z "$BASE_DIR" ]; then
+  exit 1;
+fi
+
+##########################################################################################
+# Extension to allow automatically downloading the maven-wrapper.jar from Maven-central
+# This allows using the maven wrapper in projects that prohibit checking in binary data.
+##########################################################################################
+if [ -r "$BASE_DIR/.mvn/wrapper/maven-wrapper.jar" ]; then
+    if [ "$MVNW_VERBOSE" = true ]; then
+      echo "Found .mvn/wrapper/maven-wrapper.jar"
+    fi
+else
+    if [ "$MVNW_VERBOSE" = true ]; then
+      echo "Couldn't find .mvn/wrapper/maven-wrapper.jar, downloading it ..."
+    fi
+    if [ -n "$MVNW_REPOURL" ]; then
+      jarUrl="$MVNW_REPOURL/org/apache/maven/wrapper/maven-wrapper/3.1.0/maven-wrapper-3.1.0.jar"
+    else
+      jarUrl="https://repo.maven.apache.org/maven2/org/apache/maven/wrapper/maven-wrapper/3.1.0/maven-wrapper-3.1.0.jar"
+    fi
+    while IFS="=" read key value; do
+      case "$key" in (wrapperUrl) jarUrl="$value"; break ;;
+      esac
+    done < "$BASE_DIR/.mvn/wrapper/maven-wrapper.properties"
+    if [ "$MVNW_VERBOSE" = true ]; then
+      echo "Downloading from: $jarUrl"
+    fi
+    wrapperJarPath="$BASE_DIR/.mvn/wrapper/maven-wrapper.jar"
+    if $cygwin; then
+      wrapperJarPath=`cygpath --path --windows "$wrapperJarPath"`
+    fi
+
+    if command -v wget > /dev/null; then
+        if [ "$MVNW_VERBOSE" = true ]; then
+          echo "Found wget ... using wget"
+        fi
+        if [ -z "$MVNW_USERNAME" ] || [ -z "$MVNW_PASSWORD" ]; then
+            wget "$jarUrl" -O "$wrapperJarPath" || rm -f "$wrapperJarPath"
+        else
+            wget --http-user=$MVNW_USERNAME --http-password=$MVNW_PASSWORD "$jarUrl" -O "$wrapperJarPath" || rm -f "$wrapperJarPath"
+        fi
+    elif command -v curl > /dev/null; then
+        if [ "$MVNW_VERBOSE" = true ]; then
+          echo "Found curl ... using curl"
+        fi
+        if [ -z "$MVNW_USERNAME" ] || [ -z "$MVNW_PASSWORD" ]; then
+            curl -o "$wrapperJarPath" "$jarUrl" -f
+        else
+            curl --user $MVNW_USERNAME:$MVNW_PASSWORD -o "$wrapperJarPath" "$jarUrl" -f
+        fi
+
+    else
+        if [ "$MVNW_VERBOSE" = true ]; then
+          echo "Falling back to using Java to download"
+        fi
+        javaClass="$BASE_DIR/.mvn/wrapper/MavenWrapperDownloader.java"
+        # For Cygwin, switch paths to Windows format before running javac
+        if $cygwin; then
+          javaClass=`cygpath --path --windows "$javaClass"`
+        fi
+        if [ -e "$javaClass" ]; then
+            if [ ! -e "$BASE_DIR/.mvn/wrapper/MavenWrapperDownloader.class" ]; then
+                if [ "$MVNW_VERBOSE" = true ]; then
+                  echo " - Compiling MavenWrapperDownloader.java ..."
+                fi
+                # Compiling the Java class
+                ("$JAVA_HOME/bin/javac" "$javaClass")
+            fi
+            if [ -e "$BASE_DIR/.mvn/wrapper/MavenWrapperDownloader.class" ]; then
+                # Running the downloader
+                if [ "$MVNW_VERBOSE" = true ]; then
+                  echo " - Running MavenWrapperDownloader.java ..."
+                fi
+                ("$JAVA_HOME/bin/java" -cp .mvn/wrapper MavenWrapperDownloader "$MAVEN_PROJECTBASEDIR")
+            fi
+        fi
+    fi
+fi
+##########################################################################################
+# End of extension
+##########################################################################################
+
+export MAVEN_PROJECTBASEDIR=${MAVEN_BASEDIR:-"$BASE_DIR"}
+if [ "$MVNW_VERBOSE" = true ]; then
+  echo $MAVEN_PROJECTBASEDIR
+fi
+MAVEN_OPTS="$(concat_lines "$MAVEN_PROJECTBASEDIR/.mvn/jvm.config") $MAVEN_OPTS"
+
+# For Cygwin, switch paths to Windows format before running java
+if $cygwin; then
+  [ -n "$M2_HOME" ] &&
+    M2_HOME=`cygpath --path --windows "$M2_HOME"`
+  [ -n "$JAVA_HOME" ] &&
+    JAVA_HOME=`cygpath --path --windows "$JAVA_HOME"`
+  [ -n "$CLASSPATH" ] &&
+    CLASSPATH=`cygpath --path --windows "$CLASSPATH"`
+  [ -n "$MAVEN_PROJECTBASEDIR" ] &&
+    MAVEN_PROJECTBASEDIR=`cygpath --path --windows "$MAVEN_PROJECTBASEDIR"`
+fi
+
+# Provide a "standardized" way to retrieve the CLI args that will
+# work with both Windows and non-Windows executions.
+MAVEN_CMD_LINE_ARGS="$MAVEN_CONFIG $@"
+export MAVEN_CMD_LINE_ARGS
+
+WRAPPER_LAUNCHER=org.apache.maven.wrapper.MavenWrapperMain
+
+exec "$JAVACMD" \
+  $MAVEN_OPTS \
+  $MAVEN_DEBUG_OPTS \
+  -classpath "$MAVEN_PROJECTBASEDIR/.mvn/wrapper/maven-wrapper.jar" \
+  "-Dmaven.home=${M2_HOME}" \
+  "-Dmaven.multiModuleProjectDirectory=${MAVEN_PROJECTBASEDIR}" \
+  ${WRAPPER_LAUNCHER} $MAVEN_CONFIG "$@"
Index: Server/mvnw.cmd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/Server/mvnw.cmd b/Server/mvnw.cmd
new file mode 100644
--- /dev/null	(date 1668666871426)
+++ b/Server/mvnw.cmd	(date 1668666871426)
@@ -0,0 +1,188 @@
+@REM ----------------------------------------------------------------------------
+@REM Licensed to the Apache Software Foundation (ASF) under one
+@REM or more contributor license agreements.  See the NOTICE file
+@REM distributed with this work for additional information
+@REM regarding copyright ownership.  The ASF licenses this file
+@REM to you under the Apache License, Version 2.0 (the
+@REM "License"); you may not use this file except in compliance
+@REM with the License.  You may obtain a copy of the License at
+@REM
+@REM    https://www.apache.org/licenses/LICENSE-2.0
+@REM
+@REM Unless required by applicable law or agreed to in writing,
+@REM software distributed under the License is distributed on an
+@REM "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+@REM KIND, either express or implied.  See the License for the
+@REM specific language governing permissions and limitations
+@REM under the License.
+@REM ----------------------------------------------------------------------------
+
+@REM ----------------------------------------------------------------------------
+@REM Maven Start Up Batch script
+@REM
+@REM Required ENV vars:
+@REM JAVA_HOME - location of a JDK home dir
+@REM
+@REM Optional ENV vars
+@REM M2_HOME - location of maven2's installed home dir
+@REM MAVEN_BATCH_ECHO - set to 'on' to enable the echoing of the batch commands
+@REM MAVEN_BATCH_PAUSE - set to 'on' to wait for a keystroke before ending
+@REM MAVEN_OPTS - parameters passed to the Java VM when running Maven
+@REM     e.g. to debug Maven itself, use
+@REM set MAVEN_OPTS=-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000
+@REM MAVEN_SKIP_RC - flag to disable loading of mavenrc files
+@REM ----------------------------------------------------------------------------
+
+@REM Begin all REM lines with '@' in case MAVEN_BATCH_ECHO is 'on'
+@echo off
+@REM set title of command window
+title %0
+@REM enable echoing by setting MAVEN_BATCH_ECHO to 'on'
+@if "%MAVEN_BATCH_ECHO%" == "on"  echo %MAVEN_BATCH_ECHO%
+
+@REM set %HOME% to equivalent of $HOME
+if "%HOME%" == "" (set "HOME=%HOMEDRIVE%%HOMEPATH%")
+
+@REM Execute a user defined script before this one
+if not "%MAVEN_SKIP_RC%" == "" goto skipRcPre
+@REM check for pre script, once with legacy .bat ending and once with .cmd ending
+if exist "%USERPROFILE%\mavenrc_pre.bat" call "%USERPROFILE%\mavenrc_pre.bat" %*
+if exist "%USERPROFILE%\mavenrc_pre.cmd" call "%USERPROFILE%\mavenrc_pre.cmd" %*
+:skipRcPre
+
+@setlocal
+
+set ERROR_CODE=0
+
+@REM To isolate internal variables from possible post scripts, we use another setlocal
+@setlocal
+
+@REM ==== START VALIDATION ====
+if not "%JAVA_HOME%" == "" goto OkJHome
+
+echo.
+echo Error: JAVA_HOME not found in your environment. >&2
+echo Please set the JAVA_HOME variable in your environment to match the >&2
+echo location of your Java installation. >&2
+echo.
+goto error
+
+:OkJHome
+if exist "%JAVA_HOME%\bin\java.exe" goto init
+
+echo.
+echo Error: JAVA_HOME is set to an invalid directory. >&2
+echo JAVA_HOME = "%JAVA_HOME%" >&2
+echo Please set the JAVA_HOME variable in your environment to match the >&2
+echo location of your Java installation. >&2
+echo.
+goto error
+
+@REM ==== END VALIDATION ====
+
+:init
+
+@REM Find the project base dir, i.e. the directory that contains the folder ".mvn".
+@REM Fallback to current working directory if not found.
+
+set MAVEN_PROJECTBASEDIR=%MAVEN_BASEDIR%
+IF NOT "%MAVEN_PROJECTBASEDIR%"=="" goto endDetectBaseDir
+
+set EXEC_DIR=%CD%
+set WDIR=%EXEC_DIR%
+:findBaseDir
+IF EXIST "%WDIR%"\.mvn goto baseDirFound
+cd ..
+IF "%WDIR%"=="%CD%" goto baseDirNotFound
+set WDIR=%CD%
+goto findBaseDir
+
+:baseDirFound
+set MAVEN_PROJECTBASEDIR=%WDIR%
+cd "%EXEC_DIR%"
+goto endDetectBaseDir
+
+:baseDirNotFound
+set MAVEN_PROJECTBASEDIR=%EXEC_DIR%
+cd "%EXEC_DIR%"
+
+:endDetectBaseDir
+
+IF NOT EXIST "%MAVEN_PROJECTBASEDIR%\.mvn\jvm.config" goto endReadAdditionalConfig
+
+@setlocal EnableExtensions EnableDelayedExpansion
+for /F "usebackq delims=" %%a in ("%MAVEN_PROJECTBASEDIR%\.mvn\jvm.config") do set JVM_CONFIG_MAVEN_PROPS=!JVM_CONFIG_MAVEN_PROPS! %%a
+@endlocal & set JVM_CONFIG_MAVEN_PROPS=%JVM_CONFIG_MAVEN_PROPS%
+
+:endReadAdditionalConfig
+
+SET MAVEN_JAVA_EXE="%JAVA_HOME%\bin\java.exe"
+set WRAPPER_JAR="%MAVEN_PROJECTBASEDIR%\.mvn\wrapper\maven-wrapper.jar"
+set WRAPPER_LAUNCHER=org.apache.maven.wrapper.MavenWrapperMain
+
+set DOWNLOAD_URL="https://repo.maven.apache.org/maven2/org/apache/maven/wrapper/maven-wrapper/3.1.0/maven-wrapper-3.1.0.jar"
+
+FOR /F "usebackq tokens=1,2 delims==" %%A IN ("%MAVEN_PROJECTBASEDIR%\.mvn\wrapper\maven-wrapper.properties") DO (
+    IF "%%A"=="wrapperUrl" SET DOWNLOAD_URL=%%B
+)
+
+@REM Extension to allow automatically downloading the maven-wrapper.jar from Maven-central
+@REM This allows using the maven wrapper in projects that prohibit checking in binary data.
+if exist %WRAPPER_JAR% (
+    if "%MVNW_VERBOSE%" == "true" (
+        echo Found %WRAPPER_JAR%
+    )
+) else (
+    if not "%MVNW_REPOURL%" == "" (
+        SET DOWNLOAD_URL="%MVNW_REPOURL%/org/apache/maven/wrapper/maven-wrapper/3.1.0/maven-wrapper-3.1.0.jar"
+    )
+    if "%MVNW_VERBOSE%" == "true" (
+        echo Couldn't find %WRAPPER_JAR%, downloading it ...
+        echo Downloading from: %DOWNLOAD_URL%
+    )
+
+    powershell -Command "&{"^
+		"$webclient = new-object System.Net.WebClient;"^
+		"if (-not ([string]::IsNullOrEmpty('%MVNW_USERNAME%') -and [string]::IsNullOrEmpty('%MVNW_PASSWORD%'))) {"^
+		"$webclient.Credentials = new-object System.Net.NetworkCredential('%MVNW_USERNAME%', '%MVNW_PASSWORD%');"^
+		"}"^
+		"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; $webclient.DownloadFile('%DOWNLOAD_URL%', '%WRAPPER_JAR%')"^
+		"}"
+    if "%MVNW_VERBOSE%" == "true" (
+        echo Finished downloading %WRAPPER_JAR%
+    )
+)
+@REM End of extension
+
+@REM Provide a "standardized" way to retrieve the CLI args that will
+@REM work with both Windows and non-Windows executions.
+set MAVEN_CMD_LINE_ARGS=%*
+
+%MAVEN_JAVA_EXE% ^
+  %JVM_CONFIG_MAVEN_PROPS% ^
+  %MAVEN_OPTS% ^
+  %MAVEN_DEBUG_OPTS% ^
+  -classpath %WRAPPER_JAR% ^
+  "-Dmaven.multiModuleProjectDirectory=%MAVEN_PROJECTBASEDIR%" ^
+  %WRAPPER_LAUNCHER% %MAVEN_CONFIG% %*
+if ERRORLEVEL 1 goto error
+goto end
+
+:error
+set ERROR_CODE=1
+
+:end
+@endlocal & set ERROR_CODE=%ERROR_CODE%
+
+if not "%MAVEN_SKIP_RC%"=="" goto skipRcPost
+@REM check for post script, once with legacy .bat ending and once with .cmd ending
+if exist "%USERPROFILE%\mavenrc_post.bat" call "%USERPROFILE%\mavenrc_post.bat"
+if exist "%USERPROFILE%\mavenrc_post.cmd" call "%USERPROFILE%\mavenrc_post.cmd"
+:skipRcPost
+
+@REM pause the script if MAVEN_BATCH_PAUSE is set to 'on'
+if "%MAVEN_BATCH_PAUSE%"=="on" pause
+
+if "%MAVEN_TERMINATE_CMD%"=="on" exit %ERROR_CODE%
+
+cmd /C exit /B %ERROR_CODE%
Index: Server/src/main/java/com/lkw/server/Server/handler.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/Server/src/main/java/com/lkw/server/Server/handler.java b/Server/src/main/java/com/lkw/server/Server/handler.java
new file mode 100644
--- /dev/null	(date 1668666871498)
+++ b/Server/src/main/java/com/lkw/server/Server/handler.java	(date 1668666871498)
@@ -0,0 +1,170 @@
+package com.lkw.server.Server;
+
+import com.lkw.server.Utils.Json2Object;
+import javafx.application.Platform;
+import javafx.collections.ObservableList;
+import javafx.scene.control.Button;
+import javafx.scene.control.ListView;
+import javafx.scene.control.TextArea;
+import javafx.scene.control.TextField;
+
+import java.io.*;
+import java.net.Socket;
+import java.text.SimpleDateFormat;
+import java.util.Date;
+import java.util.HashSet;
+import java.util.Map;
+import java.util.Set;
+
+/**
+ * 处理线程
+ * @author 花大侠
+ *
+ */
+public class handler implements Runnable {
+	
+	Socket socket;
+	TextArea sendMsgArea;
+	TextField statusText;
+	Button sendButton;
+	TextArea receivedMsgArea;
+	ObservableList<String> clients;
+	ListView<String> clientListView;
+	Map<String, PrintWriter> map;
+	
+	public handler() {
+		super();
+	}
+ 
+	public handler(Map<String, PrintWriter> map, Socket socket, TextArea sendMsgArea, TextField statusText, Button sendButton,
+                   TextArea receivedMsgArea, ObservableList<String> clients, ListView<String> clientListView) {
+		super();
+		this.map = map;
+		this.socket = socket;
+		this.sendMsgArea = sendMsgArea;
+		this.statusText = statusText;
+		this.sendButton = sendButton;
+		this.receivedMsgArea = receivedMsgArea;
+		this.clients = clients;
+		this.clientListView = clientListView;
+	}
+	
+	/**
+	 * 接入客户端后，更新UI界面
+	 * 1.添加新接入客户端的地址信息
+	 * 2.receivedMsgarea打印成功连接信息
+	 * 3.statusText更新成功连接个数
+	 */
+	public void updateForConnect(String remoteSocketAddress) {
+		Platform.runLater(()->{
+			clients.add(remoteSocketAddress);
+			 statusText.setText(String.valueOf(clients.size()) + " Connect success.");
+		});
+	}
+	
+	/**
+	 * 断开客户端后，更新UI界面
+	 * 1.移除断开客户端的地址信息
+	 * 2.receivedMsgarea打印断开连接信息
+	 * 3.statusText更新成功连接个数
+	 * 4.移除map中对应的remoteSocketAddress
+	 */
+	public void updateForDisConnect(String remoteSocketAddress) {
+		Platform.runLater(()->{
+			clients.remove(remoteSocketAddress);
+			statusText.setText(String.valueOf(clients.size()) + " Connect success.");
+			receivedMsgArea.appendText(remoteSocketAddress + " out of connected.." + "\n");
+			map.remove(remoteSocketAddress);
+		});
+	}
+	
+	/**
+	 * 单发及群发消息
+	 * 1.为clientListView设置监听器 
+	 *   1.1获取已选择的项(IP:Port)
+	 *   1.2从映射表中取出对应printWriter放入printWriters集合
+	 * 2.为sendButton设置鼠标点击事件
+	 *   2.1遍历printWriters集合
+	 *   2.2写入待发送的消息
+	 */
+
+	public void sendMessage() {
+		Set<PrintWriter> printWriters = new HashSet<>();
+		clientListView.getSelectionModel().selectedItemProperty().addListener(ov->{
+			printWriters.clear();
+			for(String key: clientListView.getSelectionModel().getSelectedItems()) {
+				printWriters.add(map.get(key));
+			}
+		});
+		sendButton.setOnAction(e->{
+			for (PrintWriter printWriter : printWriters) {
+				printWriter.write(sendMsgArea.getText());
+				printWriter.flush();
+			}
+		});
+	}
+	
+	@Override
+	public void run() {
+		String remoteSocketAddress = socket.getRemoteSocketAddress().toString().substring(1);
+		updateForConnect(remoteSocketAddress);
+		try {
+			InputStream in = socket.getInputStream();
+			BufferedReader bReader = new BufferedReader(new InputStreamReader(in));
+			OutputStream out = socket.getOutputStream();
+			PrintWriter pWriter = new PrintWriter(out);
+			map.put(remoteSocketAddress, pWriter);
+			//发消息
+			sendMessage();
+			//收消息
+			String json;
+			while(true) {
+				json = bReader.readLine();
+				//个人响应
+				System.out.println("收到"+json);
+
+				//解析json
+				Json2Object json2Object = new Json2Object(json);
+				//判断mode
+				String mode = json2Object.getMode();
+				if(mode.equals("login")){
+					String returnJson = json2Object.Json2PasswordCheck();
+					System.out.println("发送"+returnJson);
+					//传出的时候要加"\r\n"否则可能报错
+					pWriter.write(returnJson+ "\r\n");
+					pWriter.flush();
+				}else if(mode.equals("text")){//其他情况
+
+					receivedMsgArea.appendText( json+ "\r\n");
+					sendMessage2All(json,pWriter);
+				}
+
+
+				//群转发
+
+
+
+			}
+		} catch (IOException e) {
+			updateForDisConnect(remoteSocketAddress);
+		}
+	}
+
+	//群转发
+	public void sendMessage2All(String message, PrintWriter pWriter){
+		for (PrintWriter printWriter:map.values()){
+			//if(!pWriter.equals(printWriter)) {//群发除了自己,注释掉了判断就是都发
+			//传出的时候要加"\r\n"否则可能报错
+				printWriter.write(message+"\r\n");
+				printWriter.flush();
+			//}
+		}
+
+	}
+
+
+
+
+
+
+}
\ No newline at end of file
diff --git a/Server/HELP.md b/Server/HELP.md
new file mode 100644
